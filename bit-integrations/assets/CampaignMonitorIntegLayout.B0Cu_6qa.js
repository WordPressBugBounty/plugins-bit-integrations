var k=Object.defineProperty;var _=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var w=(l,s,i)=>s in l?k(l,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[s]=i,m=(l,s)=>{for(var i in s||(s={}))$.call(s,i)&&w(l,i,s[i]);if(_)for(var i of _(s))R.call(s,i)&&w(l,i,s[i]);return l};import{j as e,_ as a,k as T,g as q,L as S}from"./main.2.7.9.js";import{a as L,h as V,b as U}from"./Integrations.CEc3UakZ.js";import{b as P,T as A}from"./Table.Bhs4KlDc.js";import{g as B,r as E,a as g}from"./CampaignMonitorCommonFunc.BIMvlXpt.js";import{T as G}from"./TagifyInput.BafnMlYq.js";function H({campaignMonitorConf:l,setCampaignMonitorConf:s}){var d;const i=(c,n)=>{const r=m({},l);c.target.checked?r.actions.update=!0:delete r.actions.update,s(m({},r))};return e.jsx("div",{className:"pos-rel d-flx w-8",children:e.jsx(P,{checked:((d=l.actions)==null?void 0:d.update)||!1,onChange:c=>i(c),className:"wdt-200 mt-4 mr-2",value:"user_share",title:a("Update CampaignMonitor","bit-integrations"),subTitle:a("Update Responses with CampaignMonitor existing email?","bit-integrations")})})}function z({i:l,formFields:s,field:i,campaignMonitorConf:d,setCampaignMonitorConf:c}){var v,y;let n=d.subscriberFields;const r=n.filter(t=>t.required===!0)||[],j=[...n.filter(t=>t.required===!1)||[],...(d==null?void 0:d.customFields)||[]],u=T(q),{isPro:h}=u;((v=d==null?void 0:d.field_map)==null?void 0:v.length)===1&&i.campaignMonitorField===""&&c(t=>(t.field_map=B(t),t));const x=t=>{const b=m({},d);b.field_map.splice(t,0,{}),c(b)},I=t=>{const b=m({},d);b.field_map.length>1&&b.field_map.splice(t,1),c(b)},N=(t,b)=>{const F=m({},d);F.field_map[b][t.target.name]=t.target.value,t.target.value==="custom"&&(F.field_map[b].customValue=""),c(F)};return e.jsxs("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:i.formField||"",onChange:t=>N(t,l),children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),e.jsx("optgroup",{label:a("List Fields","bit-integrations"),children:s==null?void 0:s.map(t=>e.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`))}),e.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`${a("General Smart Codes","bit-integrations")} ${h?"":`(${a("Pro","bit-integrations")})`}`,children:h&&((y=L)==null?void 0:y.map(t=>e.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`)))})]}),i.formField==="custom"&&e.jsx(G,{onChange:t=>V(t,l,d,c),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:i.customValue,placeholder:a("Custom Value","bit-integrations"),formFields:s}),e.jsxs("select",{className:"btcd-paper-inp",name:"campaignMonitorField",value:l<r.length?r[l].key||"":i.campaignMonitorField||"",onChange:t=>N(t,l),disabled:l<r.length,children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),l<r.length?e.jsx("option",{value:r[l].key,children:r[l].label},r[l].key):j.map(({key:t,label:b})=>e.jsx("option",{value:t,children:b},t))]})]}),l>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>x(l),className:"icn-btn sh-sm ml-2",type:"button",children:"+"}),e.jsx("button",{onClick:()=>I(l),className:"icn-btn sh-sm ml-2",type:"button","aria-label":"btn",children:e.jsx(A,{})})]})]})}function X({formFields:l,campaignMonitorConf:s,setCampaignMonitorConf:i,isLoading:d,setIsLoading:c,setSnackbar:n}){var p,j;const r=u=>{const h=u.target.value,x=m({},s);h&&(x.listId=h),i(x),g(x,i,c,n)};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:a("Subscriber List:","bit-integrations")}),e.jsxs("select",{value:s==null?void 0:s.listId,name:"listId",id:"",className:"btcd-paper-inp w-5",onChange:r,children:[e.jsx("option",{value:"",children:a("Select Subscriber List","bit-integrations")}),((p=s==null?void 0:s.default)==null?void 0:p.campaignMonitorLists)&&s.default.campaignMonitorLists.map(u=>e.jsx("option",{value:u.listId,children:u.listName},`${u.listId}`))]}),e.jsx("button",{onClick:()=>E(s,i,c,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh CampaignMonitor campaign"'},type:"button",disabled:d,children:"↻"}),e.jsx("br",{}),e.jsx("br",{}),d&&e.jsx(S,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,translist:"scale(0.7)"}}),e.jsxs("div",{className:"mt-4",children:[e.jsx("b",{className:"wdt-100",children:a("Map Fields","bit-integrations")}),e.jsx("button",{onClick:()=>g(s,i,c,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh CampaignMonitor Field","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]}),!d&&((s==null?void 0:s.listId)||((j=s==null?void 0:s.default)==null?void 0:j.fields))&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("List Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("CampaignMonitor Fields","bit-integrations")})})]}),s.field_map.map((u,h)=>e.jsx(z,{i:h,field:u,campaignMonitorConf:s,formFields:l,setCampaignMonitorConf:i},`CampaignMonitor-m-${h+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>U(s.field_map.length,s,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Utilities","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(H,{campaignMonitorConf:s,setCampaignMonitorConf:i})]})]})}export{X as C};
