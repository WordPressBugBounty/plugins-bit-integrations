var y=Object.defineProperty;var j=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var p=(s,l,a)=>l in s?y(s,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[l]=a,o=(s,l)=>{for(var a in l||(l={}))T.call(l,a)&&p(s,a,l[a]);if(j)for(var a of j(l))_.call(l,a)&&p(s,a,l[a]);return s};import{j as t,_ as c,L as v,k as M,g as S,s as $}from"./main.2.7.8.js";import{d as R,h as V}from"./react-router-dom.BLIKw1eE.js";import{x as A}from"./Note.CbpnsFnB.js";import{a as I}from"./CopyIcn.CrDMgwxJ.js";import{b as q}from"./Table.PPpIxK2a.js";import{g as N,a as P,r as E}from"./KeapCommonFunc.DnlrGI25.js";import{a as L,h as G}from"./Integrations.DsKoVZo5.js";import{T as O}from"./TagifyInput.AWOXl6wg.js";function W({keapConf:s,setKeapConf:l,loading:a,setLoading:e}){var b;const[r,n]=R.useState({show:!1,action:()=>{}}),d=(m,h)=>{var x;const i=o({},s);(x=m.target)!=null&&x.checked?(N(s,l,e),i.actions.tags=!0):(n({show:!1}),delete i.actions.tags),n({show:"tag"}),l(o({},i))},u=()=>{n({show:!1})},g=m=>{const h=o({},s);h.selectedTags=m,l(o({},h))};return t.jsxs("div",{className:"pos-rel d-flx w-8",children:[t.jsx(q,{checked:(s==null?void 0:s.selectedTags)||!1,onChange:m=>d(m),className:"wdt-200 mt-4 mr-2",value:"tag",title:c("Add Tags","bit - integrations"),subTitle:c("Add Tags")}),t.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:c("Ok","bit-integrations"),show:r.show==="tag",close:u,action:u,title:c("Tags","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:c("Select tags","bit-integrations")}),a.tags?t.jsx(v,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(A,{options:(b=s==null?void 0:s.tags)==null?void 0:b.map(m=>({label:m.name,value:m.id})),className:"msl-wrp-options",defaultValue:s==null?void 0:s.selectedTags,onChange:m=>g(m)}),t.jsx("button",{onClick:()=>N(s,l,e),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${c("Refresh Tags","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}const K=s=>{const l={},e=window.location.href.replace(`${window.opener.location.href}/redirect`,"").split("&");e&&e.forEach(r=>{const n=r.split("=");n[1]&&(l[n[0]]=n[1])}),localStorage.setItem(`__${s}`,JSON.stringify(l)),window.close()},w=(s,l,a,e,r)=>{const n=o({},l);n.field_map.splice(s,0,{}),a(o({},n))},f=(s,l,a,e,r)=>{const n=o({},l);n.field_map.length>1&&n.field_map.splice(s,1),a(o({},n))},F=(s,l,a,e,r,n)=>{const d=o({},a);d.field_map[l][s.target.name]=s.target.value,s.target.value==="custom"&&(d.field_map[l].customValue=""),e(o({},d))};function B({i:s,formFields:l,field:a,keapConf:e,setKeapConf:r}){var m,h;if(((m=e==null?void 0:e.field_map)==null?void 0:m.length)===1&&a.keapField===""){const i=o({},e),x=P(i);i.field_map=x,r(i)}const n=e!=null&&e.customFields?[...e==null?void 0:e.contactFields,...e==null?void 0:e.customFields]:e==null?void 0:e.contactFields,d=n.filter(i=>i.required===!0)||[],u=n.filter(i=>i.required===!1)||[],g=M(S),{isPro:b}=g;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:i=>F(i,s,e,r),children:[t.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),t.jsx("optgroup",{label:c("Form Fields","bit-integrations"),children:l==null?void 0:l.map(i=>t.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`))}),t.jsx("option",{value:"custom",children:c("Custom...","bit-integrations")}),t.jsx("optgroup",{label:$(c("General Smart Codes %s","bit-integrations"),b?"":`(${c("Pro","bit-integrations")})`),children:b&&((h=L)==null?void 0:h.map(i=>t.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`)))})]}),a.formField==="custom"&&t.jsx(O,{onChange:i=>G(i,s,e,r),label:c("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:a.customValue,placeholder:c("Custom Value","bit-integrations"),formFields:l}),t.jsxs("select",{className:"btcd-paper-inp",disabled:s<d.length,name:"keapField",value:s<d.length?d[s].key||"":a.keapField||"",onChange:i=>F(i,s,e,r),children:[t.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),s<d.length?t.jsx("option",{value:d[s].key,children:d[s].label},d[s].key):u.map(({key:i,label:x})=>t.jsx("option",{value:i,children:x},i))]})]}),s>=d.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>w(s,e,r),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>f(s,e,r),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function C({formID:s,formFields:l,handleInput:a,keapConf:e,setKeapConf:r,isLoading:n,setIsLoading:d,setSnackbar:u,a:g}){const{id:b}=V();return t.jsxs(t.Fragment,{children:[n&&t.jsx(v,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mt-4",children:[t.jsx("b",{className:"wdt-100",children:c("Map Fields","bit-integrations")}),t.jsx("button",{onClick:()=>E(b,e,r,d,u),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${c("Refresh Lemlist Field","bit-integrations")}'`},type:"button",disabled:n,children:"↻"})]}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:c("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:c("Keap Fields","bit-integrations")})})]}),e.field_map.map((m,h)=>t.jsx(B,{i:h,field:m,keapConf:e,formFields:l,setKeapConf:r},`keap-m-${h+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>w(e.field_map.length,e,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:c("Utilities","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(W,{keapConf:e,setKeapConf:r,formFields:l,loading:n,setLoading:d}),t.jsx("br",{}),t.jsx("br",{})]})]})}export{C as K,K as s};
