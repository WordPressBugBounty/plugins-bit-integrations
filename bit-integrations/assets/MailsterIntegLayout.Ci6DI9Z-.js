var M=Object.defineProperty;var y=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var _=(t,i,e)=>i in t?M(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,o=(t,i)=>{for(var e in i||(i={}))V.call(i,e)&&_(t,e,i[e]);if(y)for(var e of y(i))L.call(i,e)&&_(t,e,i[e]);return t};import{j as s,_ as a,L as w,k as I,g as z,s as A}from"./main.2.7.9.js";import{d as F}from"./react-router-dom.BLIKw1eE.js";import{ak as g,x as j}from"./Note.B1QjZ60t.js";import{a as v}from"./CopyIcn.Bz4pX3qF.js";import{b as N}from"./Table.Bhs4KlDc.js";import{m as $,a as O,g as P,b as q}from"./MailsterCommonFunc.BWa4uMUX.js";import{a as E,h as R}from"./Integrations.CEc3UakZ.js";import{T as f}from"./TagifyInput.BafnMlYq.js";function H({mailsterConf:t,setMailsterConf:i,loading:e,setLoading:l}){const[d,r]=F.useState({show:!1}),x=(n,h)=>{const b=o({},t);h==="status"&&r({show:"status"}),h==="lists"&&(r({show:"lists"}),$(t,i,e,l)),h==="tags"&&(r({show:"tags"}),O(t,i,e,l)),i(o({},b))},m=()=>{r({show:!1})},p=(n,h)=>{const b=o({},t);b[h]=n,i(o({},b))};return s.jsxs("div",{className:"pos-rel d-flx w-8",children:[s.jsx(N,{checked:(t==null?void 0:t.selectedStatus)||!1,onChange:n=>x(n,"status"),className:"wdt-200 mt-4 mr-2",value:"status",title:a("Status","bit-integrations"),subTitle:a("Set the subscriber status","bit-integrations")}),s.jsx(N,{checked:t.selectedLists||!1,onChange:n=>x(n,"lists"),className:"wdt-200 mt-4 mr-2",value:"select_lists",title:a("Select Lists","bit-integrations"),subTitle:a("Choose which lists to add subscribers to.","bit-integrations")}),s.jsx(N,{checked:t.selectedTags||!1,onChange:n=>x(n,"tags"),className:"wdt-200 mt-4 mr-2",value:"select_tags",title:a("Select tags","bit-integrations"),subTitle:a("Choose which tags to add to subscribers.","bit-integrations")}),s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:a("Ok","bit-integrations"),show:d.show==="status",close:m,action:m,title:a("Status","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsxs("div",{className:"mt-2 flx",children:[a("Select subscriber status","bit-integrations"),s.jsx(g,{width:250,icnSize:17,className:"ml-1",children:s.jsx("div",{className:"txt-body",children:'If omitted, the status will be set to "Subscribed".'})})]}),s.jsx("div",{className:"mt-2",children:s.jsx(j,{options:[{label:a("Pending","bit-integrations"),value:"0"},{label:a("Subscribed","bit-integrations"),value:"1"},{label:a("Unsubscribed","bit-integrations"),value:"2"},{label:a("Hardbounced","bit-integrations"),value:"3"}],className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedStatus,onChange:n=>p(n,"selectedStatus"),singleSelect:!0,style:{width:"100%"}})})]}),s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:d.show==="lists",close:m,action:m,title:a("Lists","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsxs("div",{className:"mt-2 flx",children:[a("Select Lists","bit-integrations"),s.jsx(g,{width:250,icnSize:17,className:"ml-1",children:s.jsx("div",{className:"txt-body",children:a("Subscribers will be associated with the selected lists","bit-integrations")})})]}),e.lists?s.jsx(w,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsx("div",{className:"mt-2",children:s.jsx(j,{options:t.lists,className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedLists,onChange:n=>p(n,"selectedLists"),style:{width:"100%"}})})]}),s.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:d.show==="tags",close:m,action:m,title:a("Tags","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsxs("div",{className:"mt-2 flx",children:[a("Select tags","bit-integrations"),s.jsx(g,{width:300,icnSize:17,className:"ml-1",children:s.jsx("div",{className:"txt-body",children:a("Selected tags will be associated with the subscriber. You can also add custom tags by pressing enter or comma (,) after writing them","bit-integrations")})})]}),e.tags?s.jsx(w,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsx("div",{className:"mt-2",children:s.jsx(j,{options:t.tags,className:"msl-wrp-options",defaultValue:t==null?void 0:t.selectedTags,onChange:n=>p(n,"selectedTags"),style:{width:"100%"},customValue:!0})})]})]})}const T=(t,i,e)=>{const l=o({},i);l.field_map.splice(t,0,{}),e(o({},l))},U=(t,i,e)=>{const l=o({},i);l.field_map.length>1&&l.field_map.splice(t,1),e(o({},l))},k=(t,i,e,l)=>{const d=o({},e);d.field_map[i][t.target.name]=t.target.value,t.target.value==="custom"&&(d.field_map[i].customValue=""),l(o({},d))};function B({i:t,formFields:i,field:e,mailsterConf:l,setMailsterConf:d}){var h,b,S;const r=(l==null?void 0:l.mailsterFields.filter(c=>c.required===!0))||[],x=((h=l==null?void 0:l.mailsterFields)==null?void 0:h.filter(c=>c.required===!1))||[];if(((b=l==null?void 0:l.field_map)==null?void 0:b.length)===1&&e.mailsterFormField===""){const c=o({},l),u=P(c);c.field_map=u,d(c)}let m=[];if(e!=null&&e.mailsterFormField){const c=l.mailsterFields.filter(u=>u.key===(e==null?void 0:e.mailsterFormField));c.length&&c[0].hasOwnProperty("options")&&c[0].options.length&&(m=c[0].options)}const p=I(z),{isPro:n}=p;return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:c=>k(c,t,l,d),children:[s.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),s.jsx("optgroup",{label:a("Form Fields","bit-integrations"),children:i==null?void 0:i.map(c=>s.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`))}),s.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),s.jsx("optgroup",{label:A(a("General Smart Codes %s","bit-integrations"),n?"":`(${a("Pro","bit-integrations")})`),children:n&&((S=E)==null?void 0:S.map(c=>s.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`)))})]}),e.formField==="custom"&&s.jsx(f,{onChange:c=>R(c,t,l,d),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:a("Custom Value","bit-integrations"),formFields:i}),s.jsxs("select",{className:"btcd-paper-inp",disabled:t<r.length,name:"mailsterFormField",value:t<r?r[t].label||"":e.mailsterFormField||"",onChange:c=>k(c,t,l,d),children:[s.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),t<r.length?s.jsx("option",{value:r[t].key,children:r[t].label},r[t].key):x.map(({key:c,label:u})=>s.jsx("option",{value:c,children:u},c))]})]}),s.jsxs("div",{className:"flx integ-fld-wrp",children:[m.length>0&&s.jsx("div",{children:s.jsx(g,{width:300,icnSize:17,className:"ml-2",children:s.jsxs("div",{className:"txt-body",children:[s.jsxs("p",{children:[a("Available values or options for the selected Mailster field","bit-integrations"),":"]}),m.map((c,u)=>s.jsx("li",{children:c},u))]})})}),t>=r.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>T(t,l,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>U(t,l,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})]})})}function C({formFields:t,mailsterConf:i,setMailsterConf:e,loading:l,setLoading:d,setSnackbar:r}){const[x,m]=F.useState({name:"",auth_token:""}),[p,n]=F.useState(!1);return s.jsx(s.Fragment,{children:s.jsxs("div",{children:[s.jsx("br",{}),s.jsx("div",{className:"mt-5",children:s.jsxs("b",{className:"wdt-100",children:[a("Field Map","bit-integrations"),s.jsx("button",{onClick:()=>q(i,e,l,d),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh fields","bit-integrations")}'`},type:"button",disabled:l.customFields,children:"â†»"})]})}),l.fields&&s.jsx(w,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.jsx("br",{}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("Mailster Fields","bit-integrations")})})]}),i.mailsterFields.length>0&&s.jsxs(s.Fragment,{children:[i==null?void 0:i.field_map.map((h,b)=>s.jsx(B,{i:b,field:h,mailsterConf:i,formFields:t,setMailsterConf:e,setSnackbar:r},`rp-m-${b+9}`)),s.jsxs("div",{children:[s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>T(i.field_map.length,i,e),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:a("Utilities","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(H,{mailsterConf:i,setMailsterConf:e,loading:l,setLoading:d})]})]})]})})}export{C as M};
