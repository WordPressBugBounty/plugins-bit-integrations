var $=Object.defineProperty;var N=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var w=(t,l,e)=>l in t?$(t,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[l]=e,o=(t,l)=>{for(var e in l||(l={}))G.call(l,e)&&w(t,e,l[e]);if(N)for(var e of N(l))I.call(l,e)&&w(t,e,l[e]);return t};import{f as A,j as s,r as q,L as V}from"./main-159.js";import{d as M,_ as a}from"./bi.698.0.js";import{a as U,h as D}from"./bi.707.3.js";import{x as F,u as O,a9 as P}from"./bi.939.446.js";import{T as B}from"./bi.732.730.js";import{a as y}from"./bi.899.9.js";import{b as _}from"./bi.297.11.js";import{g as k,m as E}from"./bi.715.820.js";import{g as T}from"./bi.237.822.js";const R=(t,l,e)=>{const c=o({},l);c.field_map.splice(t,0,{}),e(o({},c))},H=(t,l,e)=>{const c=o({},l);c.field_map.length>1&&c.field_map.splice(t,1),e(o({},c))},S=(t,l,e,c)=>{const r=o({},e);r.field_map[l][t.target.name]=t.target.value,t.target.value==="custom"&&(r.field_map[l].customValue=""),c(o({},r))};function z({i:t,formFields:l,field:e,mailerLiteConf:c,setMailerLiteConf:r}){var g;const x=A(M),{isPro:u}=x,d=(c==null?void 0:c.mailerLiteFields.filter(n=>n.required===!0))||[],p=(c==null?void 0:c.mailerLiteFields.filter(n=>n.required===!1))||[];return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:n=>S(n,t,c,r),children:[s.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),s.jsx("optgroup",{label:a("Form Fields","bit-integrations"),children:l==null?void 0:l.map(n=>s.jsx("option",{value:n.name,children:n.label},`ff-rm-${n.name}`))}),s.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),s.jsx("optgroup",{label:sprintf(a("General Smart Codes %s","bit-integrations"),u?"":`(${a("Pro","bit-integrations")})`),children:u&&((g=U)==null?void 0:g.map(n=>s.jsx("option",{value:n.name,children:n.label},`ff-rm-${n.name}`)))})]}),e.formField==="custom"&&s.jsx(B,{onChange:n=>D(n,t,c,r),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:a("Custom Value","bit-integrations"),formFields:l}),s.jsxs("select",{className:"btcd-paper-inp",disabled:t<d.length,name:"mailerLiteFormField",value:t<d?d[t].label||"":e.mailerLiteFormField||"",onChange:n=>S(n,t,c,r),children:[s.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),t<d.length?s.jsx("option",{value:d[t].key,children:d[t].label},d[t].key):p.map(({key:n,label:m})=>s.jsx("option",{value:n,children:m},n))]})]}),t>=d.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>R(t,c,r),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>H(t,c,r),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function J({mailerLiteConf:t,setMailerLiteConf:l,loading:e,setLoading:c}){var n,m,v;const[r,x]=q.useState({show:!1,action:()=>{}}),u=(i,b)=>{b==="group"&&k(t,l,e,c),x({show:b}),l(h=>O(h,j=>{j.actions=o({},j.actions||{}),i.target.checked?j.actions[b]=!0:delete j.actions[b]}))},d=()=>{x({show:!1})},p=(i,b)=>{const h=o({},t);b==="group_ids"&&i.length?h.actions.group=!0:b==="group_ids"&&i.length<1&&delete h.actions.group,b==="mailer_lite_type"&&i.length?h.actions.mailer_lite_type=!0:b==="mailer_lite_type"&&i.length<1&&delete h.actions.mailer_lite_type,h[b]=i,l(o({},h))},g=[{label:a("Active","bit-integrations"),value:"active"},{label:a("Unsubscribed","bit-integrations"),value:"unsubscribed"},{label:a("Bounced","bit-integrations"),value:"bounced"},{label:a("Spam Complaints","bit-integrations"),value:"junk"},{label:a("Unconfirmed","bit-integrations"),value:"unconfirmed"}];return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"pos-rel d-flx w-8",children:[s.jsx(_,{checked:(t==null?void 0:t.group_ids.length)||!1,onChange:i=>u(i,"group"),className:"wdt-200 mt-4 mr-2",value:"group",title:a("Groups","bit-integrations"),subTitle:a("Add Groups","bit-integrations")}),s.jsx(_,{checked:(t==null?void 0:t.mailer_lite_type)||!1,onChange:i=>u(i,"mailer_lite_type"),className:"wdt-200 mt-4 mr-2",value:"type",title:a("Type","bit-integrations"),subTitle:a("Add Type","bit-integrations")}),s.jsx(_,{checked:((n=t.actions)==null?void 0:n.double_opt_in)||!1,onChange:i=>u(i,"double_opt_in"),className:"wdt-200 mt-4 mr-2",value:"double_opt_in",title:a("Double Opt-in","bit-integrations"),subTitle:a("Add Double Opt-in","bit-integrations")}),s.jsx(_,{checked:((m=t.actions)==null?void 0:m.update)||!1,isInfo:t==null?void 0:t.group_ids.length,onChange:i=>u(i,"update"),className:"wdt-200 mt-4 mr-2",value:"user_share",title:a("Update subscriber","bit-integrations"),subTitle:a("Update Responses with MailerLite exist Subscriber?","bit-integrations")})]}),s.jsxs(y,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:a("Ok","bit-integrations"),show:r.show==="group",close:d,action:d,title:a("Groups","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.group?s.jsx(V,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsxs("div",{className:"flx flx-between mt-2",children:[s.jsx(F,{className:"msl-wrp-options",defaultValue:t==null?void 0:t.group_ids,options:(v=t==null?void 0:t.groups)==null?void 0:v.map(i=>({label:i.name,value:i.group_id})),onChange:i=>p(i,"group_ids"),customValue:!0}),s.jsx("button",{onClick:()=>k(t,l,e,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${a("Refresh Groups","bit-integrations")}'`},type:"button",disabled:e.group,children:"↻"})]})]}),s.jsxs(y,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:a("Ok","bit-integrations"),show:r.show==="mailer_lite_type",close:d,action:d,title:a("Type","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsx("div",{className:"flx flx-between mt-2",children:s.jsx(F,{className:"msl-wrp-options",defaultValue:t==null?void 0:t.mailer_lite_type,options:g.map(i=>({label:i.label,value:i.value})),onChange:i=>p(i,"mailer_lite_type"),customValue:!0,singleSelect:!0})})]})]})}function es({formFields:t,handleInput:l,mailerLiteConf:e,setMailerLiteConf:c,loading:r,setLoading:x,setSnackbar:u}){const d=A(M),{isPro:p}=d;return s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Action:","bit-integrations")}),s.jsxs("select",{onChange:l,name:"action",value:e==null?void 0:e.action,className:"btcd-paper-inp w-5",children:[s.jsx("option",{value:"",children:a("Select an action","bit-integrations")}),s.jsx("option",{value:"add_subscriber","data-action_name":"add_subscriber",children:a("Add Subscriber","bit-integrations")}),s.jsx("option",{value:"delete_subscriber","data-action_name":"delete_subscriber",disabled:e.mailer_lite_type==="v1"||!p,children:p?a("Delete subscriber","bit-integrations"):T(a("Delete subscriber","bit-integrations"))}),s.jsx("option",{value:"forget_subscriber","data-action_name":"forget_subscriber",disabled:e.mailer_lite_type==="v1"||!p,children:p?a("Forget subscriber","bit-integrations"):T(a("Forget subscriber","bit-integrations"))})]}),r.field&&s.jsx(V,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(e==null?void 0:e.action)&&!(r!=null&&r.field)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-5",children:s.jsxs("b",{className:"wdt-100",children:[a("Field Map","bit-integrations"),s.jsx("button",{onClick:()=>E(e,c,r,x),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Fields"'},type:"button",disabled:r.field,children:"↻"})]})}),s.jsx("br",{}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("MailerLite Fields","bit-integrations")})})]}),e==null?void 0:e.field_map.map((g,n)=>s.jsx(z,{i:n,field:g,mailerLiteConf:e,formFields:t,setMailerLiteConf:c,setSnackbar:u},`rp-m-${n+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>R(e.field_map.length,e,c),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{})]}),(e==null?void 0:e.action)&&(e==null?void 0:e.action)!=="add_subscriber"&&s.jsx(P,{note:K}),(e==null?void 0:e.action)&&(e==null?void 0:e.action)==="add_subscriber"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:a("Utilities","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(J,{mailerLiteConf:e,setMailerLiteConf:c,formFields:t,loading:r,setLoading:x})]})]})}const K=`
    <p>${a("This action requires a MailerLite New account. It isn’t supported with Classic accounts.","bit-integrations")}</p>
  `;export{es as M};
