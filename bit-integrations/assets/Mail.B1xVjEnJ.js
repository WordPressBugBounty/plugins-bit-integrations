var W=Object.defineProperty,q=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var M=(c,o,n)=>o in c?W(c,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[o]=n,u=(c,o)=>{for(var n in o||(o={}))K.call(o,n)&&M(c,n,o[n]);if(k)for(var n of k(o))Q.call(o,n)&&M(c,n,o[n]);return c},C=(c,o)=>q(c,J(o));import{j as e,b as T,$ as X,h as Y,k as w,g as I,i as Z,_ as s,z as y}from"./main.2.7.10.js";import{d as S,u as tt}from"./react-router-dom.BLIKw1eE.js";import{S as et,a as at,C as it,g as st}from"./Integrations.BO4oRqVq.js";import{t as nt}from"./tutorialLinks.C1WWujPT.js";import{x as lt,z as A}from"./Note.BEVUC85R.js";import{S as ot}from"./SnackMsg.xGMm2bSj.js";import{b as ct}from"./Table.DVLhKUbN.js";import{T as rt}from"./TinyMCE.DprOvn37.js";import{T as dt}from"./TutorialLink.DBJO1IxA.js";import"./index.rAvPDjud.js";import"./CopyIcn.DhliU5iM.js";/* empty css                */function h({options:c,placeholder:o,action:n,className:x,isMultiple:v,allowCustomOpt:r,value:N,addable:a,titleClassName:d,title:f,jsonValue:m}){return e.jsxs("div",{className:`${d}`,children:[e.jsx("span",{children:f}),e.jsx(lt,{width:"100%",defaultValue:N,className:`btcd-paper-drpdwn msl-wrp-options ${x}`,onChange:n,singleSelect:!v,customValue:r||a,placeholder:o,jsonValue:m,options:c||[]})]})}function St({allIntegURL:c,isInfo:o,edit:n,isLearnDash:x=!1,learnDashConf:v}){var _,F,E;const[r,N]=T(X),[a,d]=T(Y),{userMail:f}=w(I),m=w(Z),[R,z]=S.useState(!1),L=tt(),[B,j]=S.useState({show:!1}),{mailLinks:b}=nt,D=w(I),{isPro:$}=D,g=()=>{const t=[];if(V()){const i=[];m.map(l=>{l.type==="email"&&i.push({label:l.label,value:`\${${l.name}}`})}),t.push({title:s("Form Fields","bit-integrations"),type:"group",childs:i})}return f&&Array.isArray(f)&&t.push({title:s("WP Emails","bit-integrations"),type:"group",childs:f}),t};S.useEffect(()=>{if(r!=null&&r.flow_details||n){const t=u({},r==null?void 0:r.flow_details);d(t)}else{const t=u({},a);a&&!(a!=null&&a.type)&&(t.type=x?"LearnDash":"Mail"),a&&!(a!=null&&a.condition)&&(t.name=x?"Send Email Leader":"Mail Integrations",t.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]},d(t))}},[]);const P=(t,i)=>{const l=u({},a);i?l.condition.action_behavior=t:l.condition.action_behavior="",d(l)},p=(t,i)=>{const l=u({},a);t==="to"?l.to=i?i.split(","):[]:t==="cc"?l.cc=i?i.split(","):[]:t==="bcc"?l.bcc=i?i.split(","):[]:t==="replyto"?l.replyto=i?i.split(","):[]:t==="attachment"?l.attachment=i?i.split(","):[]:l[t]=i,d(l)},V=()=>{for(const t of m)if(t.type==="email")return!0;return!1},H=()=>{const t=[];for(const i of m)i.type==="file"&&t.push({label:i.label,value:i.name});return t},U=({target:{value:t}})=>{d(i=>C(u({},i),{subject:(i.subject!==void 0?i.subject:"")+t})),setTimeout(()=>{t=""},100)},G=()=>{if(!a.name){j({show:!0,msg:s("Integration name can't be empty","bit-integrations")});return}if(!a.to){j({show:!0,msg:s("Email Receiver can't be empty","bit-integrations")});return}const t=C(u({},a),{learnDashConf:v});st(r,N,c,t,L,"",n,z).then(l=>{l.success?(n&&y.success("Integration Updated Successfully"),y.success("Integration Created Successfully")):y.error(l.data||l)})},O=t=>{d(i=>C(u({},i),{body:t}))};return e.jsxs("div",{children:[e.jsx(ot,{snack:B,setSnackbar:j}),b==null?void 0:b.youTubeLink,e.jsx(dt,{title:"Mail",docLink:b==null?void 0:b.docLink}),e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("Integration Name","bit-integration")}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>p("name",t.target.value),name:"name",value:a.name,type:"text",placeholder:s("Integration Name...","bit-integrations"),disabled:o}),e.jsx("br",{}),e.jsx("br",{}),n&&e.jsx(et,{entity:r.triggered_entity,setSnackbar:j}),e.jsx(h,{action:t=>p("from",t),placeholder:s("Add mail from address","bit-integrations"),value:a.from,title:e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("From","bit-integrations")}),titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.from)}),e.jsx(h,{action:t=>p("to",t),value:a.to,placeholder:s("Add Email Receiver","bit-integrations"),title:e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("To","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.to)}),e.jsx(h,{action:t=>p("cc",t),value:a.cc,placeholder:s("Add Email CC","bit-integrations"),title:e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("CC","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.cc)}),e.jsx(h,{action:t=>p("bcc",t),placeholder:s("Add Email BCC","bit-integrations"),value:a.bcc,title:e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("BCC","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.bcc)}),e.jsx(h,{action:t=>p("replyto",t),placeholder:s("Reply To","bit-integrations"),value:a.replyto,title:e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("Reply To","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.replyto)}),e.jsx(h,{action:t=>p("attachment",t),placeholder:s("Attachment","bit-integrations"),value:(a==null?void 0:a.attachment)||[],title:e.jsx("span",{className:"f-m wdt-200 d-in-b",children:s("Attachment","bit-integrations")}),isMultiple:!0,disableChip:!1,customValue:!1,addable:!0,titleClassName:"mt-2 flx",className:"w-5",options:H()}),e.jsxs("div",{className:"mt-2 mb-4 flx",children:[e.jsx("span",{className:"f-m wdt-200 d-in-b",children:"Subject:"}),e.jsx("input",{onChange:t=>p("subject",t.target.value),name:"sub",type:"text",className:"btcd-paper-inp w-5",placeholder:"Email Subject Here",value:a.subject}),e.jsxs("select",{onChange:U,className:"btcd-paper-inp ml-2",style:{width:"20%"},children:[e.jsx("option",{value:"",children:s("Add field","bit-integrations")}),e.jsx("optgroup",{label:s("Form Fields","bit-integrations"),children:m!==null&&m.map(t=>t.type!==void 0&&!t.type.match(/^(file|recaptcha)$/)&&e.jsx("option",{value:`\${${t.name}}`,children:t.label},t.name))}),e.jsx("optgroup",{label:`${s("General Smart Codes","bit-integrations")} ${$?"":`(${s("Pro","bit-integrations")})`}`,children:$&&((_=at)==null?void 0:_.map(t=>e.jsx("option",{value:`\${${t.name}}`,children:t.label},`ff-rm-${t.name}`)))})]})]}),e.jsx(rt,{id:"conf-mail",formFields:m,value:a.body,onChangeHandler:O,width:"100%"}),(a==null?void 0:a.condition)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flx",children:e.jsx(ct,{onChange:t=>P(t.target.value,t.target.checked),checked:((F=a==null?void 0:a.condition)==null?void 0:F.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:s("Conditional Logics","bit_integration")})}),e.jsx("br",{}),((E=a==null?void 0:a.condition)==null?void 0:E.action_behavior)==="cond"&&e.jsx(it,{formFields:m,dataConf:a,setDataConf:d})]}),e.jsx(mt,{saveConfig:G,isLoading:R,edit:(r==null?void 0:r.flow_details)&&!0})]})}const mt=({saveConfig:c,edit:o,isLoading:n})=>o?e.jsx("div",{className:"txt-center w-9 mt-3",children:e.jsxs("button",{onClick:c,className:"btn btcd-btn-lg purple sh-sm flx",type:"button",disabled:n,children:[s("Update","bit-integrations"),n&&e.jsx(A,{size:20,clr:"#022217",className:"ml-2"})]})}):e.jsx("div",{className:"btcd-stp-page txt-center",style:{width:"100%",height:"auto"},children:e.jsxs("button",{onClick:c,className:"btn btcd-btn-lg purple sh-sm",type:"button",disabled:n,children:[s("Save","bit-integrations"),"âœ”",n&&e.jsx(A,{size:20,clr:"#022217",className:"ml-2"})]})});export{St as default};
