import{d as k,z as _,_ as i,k as T,g as q,j as a,s as w,L as M}from"./main.2.7.9.js";import{u as h,x as j}from"./Note.B1QjZ60t.js";import{c as N,g as V}from"./ProUtilHelpers.HxY5rljX.js";import{a as $,b as R}from"./Integrations.CEc3UakZ.js";import{T as L}from"./TagifyInput.BafnMlYq.js";import{h as v,a as E,b as z,d as D}from"./GlobalIntegrationHelper.Cep5Jt9C.js";const Y=(s,n,t)=>{const{name:l,value:d}=s.target;t(b=>h(b,u=>{u[l]=d}))},y=(s,n)=>{n(!0),k(null,"refresh_mailer_press_lists").then(t=>{var l;if(t&&(t!=null&&t.success)&&((l=t==null?void 0:t.data)!=null&&l.lists)){s(d=>h(d,b=>{b.allLists=t.data.lists})),n(!1),_.success(i("All lists fetched successfully","bit-integrations"));return}n(!1),_.error(i("MailerPress list fetch failed. Please try again","bit-integrations"))}).catch(()=>n(!1))},A=(s,n)=>{n(!0),k(null,"refresh_mailer_press_tags").then(t=>{var l;if(t&&(t!=null&&t.success)&&((l=t==null?void 0:t.data)!=null&&l.tagList)){s(d=>h(d,b=>{b.allTags=t.data.tagList})),n(!1),_.success(i("All tags fetched successfully","bit-integrations"));return}n(!1),_.error(i("MailerPress tags fetch failed. Please try again","bit-integrations"))}).catch(()=>n(!1))},Z=s=>!((s!=null&&s.field_map?s.field_map.filter(t=>!t.formField||!t.mailerPressField||t.formField==="custom"&&!t.customValue):[]).length>0),G=s=>{const n=s.filter(t=>t.required===!0);return n.length>0?n.map(t=>({formField:"",mailerPressField:t.key})):[{formField:"",mailerPressField:""}]};function O({i:s,formFields:n,field:t,mailerPressConf:l,setMailerPressConf:d}){var m;const b=T(q),{isPro:u}=b,o=(l==null?void 0:l.mailerPressFields.filter(c=>c.required===!0))||[],g=(l==null?void 0:l.mailerPressFields.filter(c=>c.required===!1))||[];return a.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:a.jsxs("div",{className:"pos-rel flx",children:[a.jsxs("div",{className:"flx integ-fld-wrp",children:[a.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:t.formField||"",onChange:c=>v(c,s,l,d),children:[a.jsx("option",{value:"",children:i("Select Field","bit-integrations")}),a.jsx("optgroup",{label:i("Form Fields","bit-integrations"),children:n==null?void 0:n.map(c=>a.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`))}),a.jsx("option",{value:"custom",children:i("Custom...","bit-integrations")}),a.jsx("optgroup",{label:w(i("General Smart Codes %s","bit-integrations"),u?"":`(${i("Pro","bit-integrations")})`),children:u&&((m=$)==null?void 0:m.map(c=>a.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`)))})]}),t.formField==="custom"&&a.jsx(L,{onChange:c=>E(c,s,l,d),label:i("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:t.customValue,placeholder:i("Custom Value","bit-integrations"),formFields:n}),a.jsxs("select",{className:"btcd-paper-inp",disabled:s<o.length,name:"mailerPressField",value:s<o?o[s].label||"":t.mailerPressField||"",onChange:c=>v(c,s,l,d),children:[a.jsx("option",{value:"",children:i("Select Field","bit-integrations")}),s<o.length?a.jsx("option",{value:o[s].key,children:o[s].label},o[s].key):g.map(({key:c,label:x})=>a.jsx("option",{value:c,children:x},c))]})]}),s>=o.length&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>z(s,l,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),a.jsx("button",{onClick:()=>D(s,l,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:a.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}const F=[{name:"create_or_update_contact",label:i("Create or Update Contact","bit-integrations"),is_pro:!1},{name:"delete_contact",label:i("Delete Contact","bit-integrations"),is_pro:!0},{name:"add_tags",label:i("Add Tags to Contact","bit-integrations"),is_pro:!0},{name:"remove_tags",label:i("Remove Tags from Contact","bit-integrations"),is_pro:!0},{name:"add_to_lists",label:i("Add Contact to Lists","bit-integrations"),is_pro:!0},{name:"remove_from_lists",label:i("Remove Contact from Lists","bit-integrations"),is_pro:!0}],U=[{label:i("Email Address","bit-integrations"),key:"email",required:!0},{label:i("First Name","bit-integrations"),key:"first_name",required:!1},{label:i("Last Name","bit-integrations"),key:"last_name",required:!1},{label:i("Status","bit-integrations"),key:"status",required:!1}],B=[{label:i("Email Address","bit-integrations"),key:"email",required:!0}];function I({formID:s,formFields:n,mailerPressConf:t,setMailerPressConf:l,isLoading:d,setIsLoading:b,setSnackbar:u}){var x;const o=T(q),{isPro:g}=o,m=(e,r)=>{l(p=>h(p,S=>{S[r]=e}))},c=e=>{l(r=>h(r,p=>{p.mainAction=e,p.mailerPressFields=e==="create_or_update_contact"?U:B,p.field_map=G(p.mailerPressFields)})),["create_or_update_contact","add_tags","remove_tags"].includes(e)&&A(l,b),["create_or_update_contact","add_to_lists","remove_from_lists"].includes(e)&&y(l,b)};return a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsxs("div",{className:"flx",children:[a.jsx("b",{className:"wdt-200 d-in-b",children:i("Action:","bit-integrations")}),a.jsx(j,{title:"mainAction",defaultValue:(x=t==null?void 0:t.mainAction)!=null?x:null,className:"mt-2 w-5",onChange:e=>c(e),options:F==null?void 0:F.map(e=>({label:N(g,e.is_pro)?e.label:V(e.label),value:e.name,disabled:!N(g,e.is_pro)})),singleSelect:!0,closeOnSelect:!0})]}),["create_or_update_contact","add_to_lists","remove_from_lists"].includes(t==null?void 0:t.mainAction)&&a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsxs("div",{className:"flx",children:[a.jsx("b",{className:"wdt-200 d-in-b",children:i("Lists:","bit-integrations")}),a.jsx(j,{title:"lists",defaultValue:t==null?void 0:t.lists,className:"btcd-paper-drpdwn w-5",options:(t==null?void 0:t.allLists)&&Array.isArray(t.allLists)&&t.allLists.map(e=>{var r;return{label:e==null?void 0:e.listName,value:(r=e==null?void 0:e.listId)==null?void 0:r.toString()}}),onChange:e=>m(e,"lists")}),a.jsx("button",{onClick:()=>y(l,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh MailerPress Lists","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]})]}),["create_or_update_contact","add_tags","remove_tags"].includes(t==null?void 0:t.mainAction)&&a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsxs("div",{className:"flx",children:[a.jsx("b",{className:"wdt-200 d-in-b",children:i("Tags:","bit-integrations")}),a.jsx(j,{title:"tags",defaultValue:t==null?void 0:t.tags,className:"btcd-paper-drpdwn w-5",options:(t==null?void 0:t.allTags)&&Array.isArray(t.allTags)&&t.allTags.map(e=>{var r;return{label:e==null?void 0:e.tagName,value:(r=e==null?void 0:e.tagId)==null?void 0:r.toString()}}),onChange:e=>m(e,"tags")}),a.jsx("button",{onClick:()=>A(l,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh MailerPress Tags","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]})]}),d&&a.jsx(M,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(t==null?void 0:t.mainAction)&&(t==null?void 0:t.mailerPressFields)&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-4",children:a.jsx("b",{className:"wdt-100",children:i("Map Fields","bit-integrations")})}),a.jsx("div",{className:"btcd-hr mt-1"}),a.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:i("Form Fields","bit-integrations")})}),a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:i("MailerPress Fields","bit-integrations")})})]}),t==null?void 0:t.field_map.map((e,r)=>a.jsx(O,{i:r,field:e,mailerPressConf:t,formFields:n,setMailerPressConf:l},`mailerpress-m-${r+9}`)),a.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:a.jsx("button",{onClick:()=>R(t.field_map.length,t,l),className:"icn-btn sh-sm",type:"button",children:"+"})}),a.jsx("br",{}),a.jsx("br",{})]})]})}export{I as M,Z as c,Y as h};
