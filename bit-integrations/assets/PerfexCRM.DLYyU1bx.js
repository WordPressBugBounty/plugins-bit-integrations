var T=Object.defineProperty;var S=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var P=(s,i,r)=>i in s?T(s,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[i]=r,C=(s,i)=>{for(var r in i||(i={}))F.call(i,r)&&P(s,r,i[r]);if(S)for(var r of S(i))R.call(i,r)&&P(s,r,i[r]);return s};import{_ as e,j as n,z as a}from"./main.2.7.11.js";import{u as z,d as l}from"./react-router-dom.BLIKw1eE.js";import"./Note.iI4FM_zT.js";import{S as B}from"./SnackMsg.DJhRycHe.js";import{S as A}from"./Steps.KpTwh2fS.js";import{I as D,g as E}from"./Integrations.CiiC6YXN.js";import M from"./PerfexCRMAuthorization.Bw-v7XXv.js";import{h as Z,c as x}from"./PerfexCRMCommonFunc.ak2lHpT-.js";import{P as H}from"./PerfexCRMIntegLayout.UZOz_yXn.js";import"./CopyIcn.DaX9e6Na.js";import"./Table.NqkguWs5.js";import"./index.rAvPDjud.js";import"./TutorialLink.BQJGOONg.js";import"./tutorialLinks.C1WWujPT.js";import"./TagifyInput.ey_dUHW4.js";import"./tagify.YxUZd8Ix.js";function ne({formFields:s,setFlow:i,flow:r,allIntegURL:p}){const m=z(),[f,c]=l.useState(!1),[y,k]=l.useState({}),[o,q]=l.useState(1),[N,g]=l.useState({show:!1}),_=[{key:"company",label:e("Company","bit-integrations"),required:!0},{key:"vat",label:e("VAT Number","bit-integrations"),required:!1},{key:"phonenumber",label:e("Phone Number","bit-integrations"),required:!1},{key:"website",label:e("Website","bit-integrations"),required:!1},{key:"address",label:e("Address","bit-integrations"),required:!1},{key:"city",label:e("City","bit-integrations"),required:!1},{key:"state",label:e("State","bit-integrations"),required:!1},{key:"zip",label:e("Zip","bit-integrations"),required:!1},{key:"country",label:e("Country","bit-integrations"),required:!1},{key:"billing_street",label:e("Billing Street","bit-integrations"),required:!1},{key:"billing_city",label:e("Billing City","bit-integrations"),required:!1},{key:"billing_state",label:e("Billing State","bit-integrations"),required:!1},{key:"billing_zip",label:e("Billing Zip","bit-integrations"),required:!1},{key:"billing_country",label:e("Billing Country","bit-integrations"),required:!1},{key:"shipping_street",label:e("Shipping Street","bit-integrations"),required:!1},{key:"shipping_city",label:e("Shipping City","bit-integrations"),required:!1},{key:"shipping_state",label:e("Shipping State","bit-integrations"),required:!1},{key:"shipping_zip",label:e("Shipping Zip","bit-integrations"),required:!1},{key:"shipping_country",label:e("Shipping Country","bit-integrations"),required:!1}],j=[{key:"firstname",label:e("First Name","bit-integrations"),required:!0},{key:"lastname",label:e("Last Name","bit-integrations"),required:!0},{key:"email",label:e("Email Address","bit-integrations"),required:!0},{key:"title",label:e("Position","bit-integrations"),required:!1},{key:"phonenumber",label:e("Phone Number","bit-integrations"),required:!1},{key:"password",label:e("Password","bit-integrations"),required:!1}],v=[{key:"name",label:e("Name","bit-integrations"),required:!0},{key:"title",label:e("Position","bit-integrations"),required:!1},{key:"email",label:e("Email Address","bit-integrations"),required:!1},{key:"website",label:e("Website","bit-integrations"),required:!1},{key:"phonenumber",label:e("Phone Number","bit-integrations"),required:!1},{key:"company",label:e("Company","bit-integrations"),required:!1},{key:"address",label:e("Address","bit-integrations"),required:!1},{key:"city",label:e("City","bit-integrations"),required:!1},{key:"state",label:e("State","bit-integrations"),required:!1},{key:"zip",label:e("Zip","bit-integrations"),required:!1},{key:"country",label:e("Country","bit-integrations"),required:!1},{key:"description",label:e("Description","bit-integrations"),required:!1},{key:"custom_contact_date",label:e("Date Contacted","bit-integrations"),required:!1}],I=[{key:"name",label:e("Name","bit-integrations"),required:!0},{key:"start_date",label:e("Start Date","bit-integrations"),required:!0},{key:"deadline",label:e("Dead Line","bit-integrations"),required:!1},{key:"project_cost ",label:e("project Cost","bit-integrations"),required:!1},{key:"estimated_hours",label:e("Estimated Hours","bit-integrations"),required:!1},{key:"description",label:e("Project Description","bit-integrations"),required:!1}],[t,d]=l.useState({name:"PerfexCRM",type:"PerfexCRM",api_token:"",domain:"",field_map:[{formField:"",perfexCRMFormField:""}],actionName:"",selectedLeadSourceId:1,selectedLeadStatusId:1,actionId:"",customerFields:_,contactFields:j,leadFields:v,projectFields:I,actions:{}}),L=()=>{c(!0),E(r,i,p,t,m,"","",c).then(u=>{var h;u.success?(a.success((h=u.data)==null?void 0:h.msg),m(p)):a.error(u.data||u)})},w=b=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!x(t)){a.error(e("Please map mandatory fields","bit-integrations"));return}if(t.actionName==="contact"&&!t.selectedCustomer){a.error(e("Please select a Customer","bit-integrations"));return}if(t.actionName==="lead"&&(!t.selectedLeadStatusId||!t.selectedLeadSourceId||!t.selectedStaff)){a.error(e("Lead Status Id and Lead Source Id are required!","bit-integrations"));return}if(t.actionName==="project"){if(!t.selectedProjectStatus){a.error(e("Please select Project status","bit-integrations"));return}if(!t.selectedProjectType){a.error(e("Please select Project Related With...","bit-integrations"));return}if(!t.selectedbillingType){a.error(e("Please select a Billing type","bit-integrations"));return}if(!t.selectedCustomer){a.error(e("Please select a Customer","bit-integrations"));return}if(Number(t.selectedbillingType)===1&&!t.totalRate){a.error(e("Please select a Total Rate","bit-integrations"));return}if(Number(t.selectedbillingType)===2&&!t.ratePerHour){a.error(e("Please select a Rate Per Hour","bit-integrations"));return}}t.field_map.length>0&&q(b)};return n.jsxs("div",{children:[n.jsx(B,{snack:N,setSnackbar:g}),n.jsx("div",{className:"txt-center mt-2",children:n.jsx(A,{step:3,active:o})}),n.jsx(M,{perfexCRMConf:t,setPerfexCRMConf:d,step:o,setStep:q,loading:y,setLoading:k,setSnackbar:g}),n.jsxs("div",{className:"btcd-stp-page",style:C({},o===2&&{width:900,height:"auto",overflow:"visible"}),children:[n.jsx(H,{formFields:s,handleInput:b=>Z(b,t,d),perfexCRMConf:t,setPerfexCRMConf:d,loading:y,setLoading:k,isLoading:f,setIsLoading:c,setSnackbar:g}),(t==null?void 0:t.actionName)&&n.jsxs("button",{onClick:()=>w(3),disabled:!x(t),className:"btn f-right btcd-btn-lg purple sh-sm flx",type:"button",children:[e("Next","bit-integrations")," Â ",n.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(t==null?void 0:t.actionName)&&n.jsx(D,{step:o,saveConfig:()=>L(),isLoading:f,dataConf:t,setDataConf:d,formFields:s})]})}export{ne as default};
