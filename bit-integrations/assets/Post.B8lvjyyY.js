var K=Object.defineProperty;var k=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var q=(d,o,c)=>o in d?K(d,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[o]=c,g=(d,o)=>{for(var c in o||(o={}))Q.call(o,c)&&q(d,c,o[c]);if(k)for(var c of k(o))V.call(o,c)&&q(d,c,o[c]);return d};import{k as X,g as Y,d as P,j as t,_ as s}from"./main.2.7.11.js";import{d as p,u as Z,h as tt}from"./react-router-dom.BLIKw1eE.js";import{ak as j}from"./Note.iI4FM_zT.js";import{S as et}from"./SnackMsg.DJhRycHe.js";import{S as st}from"./Steps.KpTwh2fS.js";import{r as it,F as at,a as nt,C as rt,c as lt,b as ot,d as ct,e as dt}from"./FieldMap.gq5ZW06u.js";import{p as I}from"./postField.DeM1hjB4.js";import{I as mt,g as pt}from"./Integrations.CiiC6YXN.js";import{t as ut}from"./tutorialLinks.C1WWujPT.js";import{T as M}from"./TutorialLink.BQJGOONg.js";import{P as bt}from"./ActionProFeatureLabels.BkKp34Zv.js";import"./CopyIcn.DaX9e6Na.js";import"./Table.NqkguWs5.js";import"./index.rAvPDjud.js";import"./TagifyInput.ey_dUHW4.js";import"./tagify.YxUZd8Ix.js";function Mt({formFields:d,setFlow:o,flow:c,allIntegURL:N}){var F;const[_,T]=p.useState([]),[x,y]=p.useState([]),S=Z(),{formID:L}=tt(),[C,v]=p.useState(!1),[f,A]=p.useState(1),[D,m]=p.useState({show:!1}),[E,W]=p.useState({fields:[],files:[]}),[$,z]=p.useState({fields:[],files:[]}),[J,O]=p.useState({fields:[],files:[]}),{postCreation:b}=ut,R=X(Y),{isPro:U}=R,[a,u]=p.useState({name:"WP Post Creation",type:"WP Post Creation",post_map:[{post_author:"logged_in_user"}],acf_map:[{}],acf_file_map:[{}],metabox_map:[{}],metabox_file_map:[{}],je_cpt_meta_map:[{}],je_cpt_file_map:[{}]}),h=(e,i)=>{const n=g({},a);n[e]=i,u(n)};p.useEffect(()=>{P({},"user/list").then(i=>{const{data:n}=i;T(n)}),P({},"post-types/list").then(i=>{const{data:n}=i;y(n)});const e=g({},a);e.post_map=I.filter(i=>i.required).map(i=>({formField:"",postField:i.key,required:i.required})),u(e)},[]);const B=(e,i)=>{const n=g({},a);n[e]=i,P({post_type:i},"customfield/list").then(H=>{const{data:r}=H;W({fields:r.acf_fields,files:r.acf_files}),z({fields:r.mb_fields,files:r.mb_files}),O({fields:r.je_cpt_fields,files:r.je_cpt_files}),r!=null&&r.acf_fields&&(n.acf_map=r.acf_fields.filter(l=>l.required).map(l=>({formField:"",acfField:l.key,required:l.required})),n.acf_map.length<1&&(n.acf_map=[{}])),r!=null&&r.mb_fields&&(n.metabox_map=r.mb_fields.filter(l=>l.required).map(l=>({formField:"",metaboxField:l.key,required:l.required})),n.metabox_map.length<1&&(n.metabox_map=[{}])),r!=null&&r.je_cpt_fields&&(n.je_cpt_meta_map=r.je_cpt_fields.filter(l=>l.required).map(l=>({formField:"",jeCPTField:l.key,required:l.required}))),n.je_cpt_meta_map.length<1&&(n.je_cpt_meta_map=[{}])}),u(n)},w=e=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!lt(a)){m({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!a.post_type){m({show:!0,msg:s("Post Type can't be empty","bit-integrations")});return}if(!a.post_status){m({show:!0,msg:s("Post Status can't be empty","bit-integrations")});return}if(e===3){if(!ot(a)){m({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!ct(a)){m({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!dt(a)){m({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}}A(e)},G=()=>{v(!0),pt(c,o,N,a,S,"","",v).then(i=>{var n;i.success?(m({show:!0,msg:(n=i.data)==null?void 0:n.msg}),S(N)):m({show:!0,msg:i.data||i})})};return t.jsxs("div",{children:[t.jsx(et,{snack:D,setSnackbar:m}),t.jsx(M,{title:"WP Post Creation",youTubeLink:b==null?void 0:b.youTubeLink}),t.jsx(M,{title:"WP Post Creation",docLink:b==null?void 0:b.docLink}),t.jsx("div",{className:"txt-center mt-2",children:t.jsx(st,{step:3,active:f})}),t.jsxs("div",{className:"btcd-stp-page",style:{width:f===1&&900,height:f===1&&"auto"},children:[t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:s("Integration Name","bit-integrations")})}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:e=>h(e.target.name,e.target.value),name:"name",value:a.name,type:"text",placeholder:s("Integration Name...","bit-integrations")}),t.jsxs("div",{className:"mt-3 flx",children:[t.jsx("b",{children:s("Post Type","bit-integrations")}),t.jsx(j,{width:250,icnSize:17,className:"ml-2",children:t.jsxs("div",{className:"txt-body",children:[s("Select one of the defined WordPress post types Or custom post types for the post","bit-integrations"),t.jsx("br",{})]})})]}),t.jsxs("div",{children:[t.jsxs("select",{name:"post_type",onChange:e=>B(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-1",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Post Type","bit-integrations")}),x==null?void 0:x.map((e,i)=>t.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.title},`acf-${i*2}`))]}),t.jsx("button",{onClick:()=>it(x,y),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${s("Refresh Post Types","bit-integrations")}'`},type:"button",children:"â†»"})]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("b",{children:s("Post Status","bit-integrations")}),t.jsx(j,{width:250,icnSize:17,className:"ml-2",children:t.jsxs("div",{className:"txt-body",children:[s("Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled","bit-integrations"),t.jsx("br",{})]})})]}),t.jsxs("select",{name:"post_status",onChange:e=>h(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-2",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Status","bit-integrations")}),t.jsx("option",{value:"publish",children:s("Publish","bit-integrations")}),t.jsx("option",{value:"draft",children:s("Draft","bit-integrations")}),t.jsx("option",{value:"auto-draft",children:s("Auto-Draft","bit-integrations")}),t.jsx("option",{value:"private",children:s("Private","bit-integrations")}),t.jsx("option",{value:"pending",children:s("Pending","bit-integrations")})]}),t.jsxs("div",{className:"mt-3 flx",children:[t.jsx("b",{children:s("Author","bit-integrations")}),t.jsx(j,{width:250,icnSize:17,className:"ml-2",children:t.jsxs("div",{className:"txt-body",children:["bit-integrations",t.jsx("br",{})]})})]}),t.jsx("div",{children:t.jsxs("select",{name:"post_author",onChange:e=>h(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-2",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Author","bit-integrations")}),t.jsx("option",{value:"logged_in_user",children:s("Logged In User","bit-integrations")}),_==null?void 0:_.map((e,i)=>t.jsx("option",{value:e.ID,children:e.display_name},`acf-${i*2}`))]})}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:s("Comment Status","bit-integrations")})}),t.jsxs("select",{name:"comment_status",onChange:e=>h(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-2",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Status","bit-integrations")}),t.jsx("option",{value:"open",children:s("Open","bit-integrations")}),t.jsx("option",{value:"closed",children:s("Closed","bit-integrations")})]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("b",{children:t.jsx(bt,{title:s("Add Post Tags","bit-integrations")})}),t.jsx(j,{width:250,icnSize:17,className:"ml-2",children:t.jsxs("div",{className:"txt-body",children:[s("Use commas to separate multiple tags. Example: tag1, tag2, tag3","bit-integrations"),t.jsx("br",{})]})})]}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-2 ",onChange:e=>h(e.target.name,e.target.value),name:"post_tags",value:a.post_tags,type:"text",placeholder:s("Add Post Tags...","bit-integrations"),disabled:!U}),t.jsxs("div",{children:[t.jsx("div",{className:"mt-3 mb-1",children:t.jsx("b",{children:s("Post Field Mapping","bit-integrations")})}),t.jsx("div",{className:"btcd-hr"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Post Fields","bit-integrations")})})]})]}),(F=a==null?void 0:a.post_map)==null?void 0:F.map((e,i)=>t.jsx(at,{i,type:"post",field:e,formFields:d,postConf:a,setPostConf:u,customFields:I},`analytics-m-${i+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>nt("post_map",a.post_map.length,a,u),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsxs("button",{onClick:()=>w(2),className:"btn f-right btcd-btn-lg purple sh-sm flx",type:"button",children:[s("Next","bit-integrations"),t.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),t.jsxs("div",{className:"btcd-stp-page",style:g({},f===2&&{width:900,height:"auto",overflow:"visible"}),children:[t.jsx(rt,{formID:L,formFields:d,handleInput:e=>h(e,a),postConf:a,setPostConf:u,isLoading:C,setIsLoading:v,setSnackbar:m,acfFields:E,mbFields:$,jeCPTFields:J}),t.jsxs("button",{onClick:()=>w(3),className:"btn f-right btcd-btn-lg purple sh-sm flx",type:"button",children:[s("Next","bit-integrations"),t.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),t.jsx(mt,{step:f,saveConfig:()=>G(),isLoading:C,dataConf:a,setDataConf:u,formFields:d})]})}export{Mt as default};
