var P=Object.defineProperty,A=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var h=(s,t,a)=>t in s?P(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,b=(s,t)=>{for(var a in t||(t={}))R.call(t,a)&&h(s,a,t[a]);if(g)for(var a of g(t))$.call(t,a)&&h(s,a,t[a]);return s},w=(s,t)=>A(s,M(t));import{u as V,e as x,r as u,f as W,j as r}from"./main-174.js";import{$ as q,e as D,f as T,_ as m}from"./bi.964.0.js";import{S as z}from"./bi.404.13.js";import{ak as F}from"./bi.89.470.js";import{S as B,I as G,s as _}from"./bi.48.3.js";import{h as H,i as J,c as y}from"./bi.58.913.js";import{F as K}from"./bi.183.914.js";import"./bi.873.9.js";import"./bi.755.11.js";import"./bi.410.14.js";import"./bi.54.773.js";import"./bi.573.774.js";function me({allIntegURL:s}){const t=V(),[a,O]=x(q),[e,l]=x(D),[d,p]=u.useState({list:!1,field:!1,auth:!1}),[N,o]=u.useState({show:!1}),c=W(T),[j,k]=u.useState(e.name||""),v=()=>(Array.isArray(e==null?void 0:e.field_map)?e.field_map:[]).find(i=>(i==null?void 0:i.fabmanFormField)==="emailAddress"),S=()=>{const n=v();if(!n)return!0;if(n.formField==="custom"){const f=(n.customValue||"").trim();return!f||!F(f)}const i=(c||[]).find(f=>f.name===n.formField);if(!i)return!0;const E=i.type&&String(i.type).toLowerCase()==="email",L=/email/i.test(i.name||"")||/email/i.test(i.label||"");return!E&&i.type&&!L},C=()=>{if(!e.actionName){o({show:!0,msg:m("Please select an action","bit-integrations")});return}if(["update_member","delete_member"].includes(e.actionName)){if(!y(e)){o({show:!0,msg:m("Please map mandatory fields","bit-integrations")});return}if(S()){o({show:!0,msg:m("Please map a valid email address","bit-integrations")});return}_({flow:a,allIntegURL:s,conf:e,navigate:t,edit:1,setLoading:p,setSnackbar:o});return}if(!y(e)){o({show:!0,msg:m("Please map mandatory fields","bit-integrations")});return}if((e.actionName==="update_spaces"||e.actionName==="delete_spaces")&&!e.selectedWorkspace){o({show:!0,msg:m("Please select a workspace","bit-integrations")});return}_({flow:a,allIntegURL:s,conf:e,navigate:t,edit:1,setLoading:p,setSnackbar:o})},I=n=>{k(n.target.value),l(i=>w(b({},i),{name:n.target.value}))};return r.jsxs("div",{style:{width:900},children:[r.jsx(z,{snack:N,setSnackbar:o}),r.jsxs("div",{className:"flx mt-3",children:[r.jsx("b",{className:"wdt-200 d-in-b",children:m("Integration Name:","bit-integrations")}),r.jsx("input",{className:"btcd-paper-inp w-5",onChange:I,name:"name",value:j,type:"text",placeholder:m("Integration Name...","bit-integrations")})]}),r.jsx("br",{}),r.jsx(B,{entity:a.triggered_entity,setSnackbar:o}),r.jsx(K,{formID:a.triggered_entity_id,formFields:c,handleInput:n=>H(n,e,l),fabmanConf:e,setFabmanConf:l,loading:d,setLoading:p,setSnackbar:o}),r.jsx(G,{edit:!0,saveConfig:C,disabled:J(e,c,F),isLoading:d.list||d.field||d.auth,dataConf:e,setDataConf:l,formFields:c}),r.jsx("br",{})]})}export{me as default};
