import{f as S,j as l,L as V}from"./main-174.js";import{u as h,x as v}from"./bi.89.470.js";import{c as T,z as M,_ as s,d as k,s as $}from"./bi.964.0.js";import{c as y,g as q}from"./bi.45.805.js";import{a as P,b as O}from"./bi.48.3.js";import{T as U}from"./bi.54.773.js";import{h as R,a as z,b as E,d as D}from"./bi.954.806.js";const I=(i,m,e)=>{const{name:t,value:d}=i.target;e(n=>h(n,u=>{u[t]=d}))},A=(i,m)=>{m(!0),T(null,"teams_for_wc_memberships_refresh_teams").then(e=>{var t;if(e&&(e!=null&&e.success)&&((t=e==null?void 0:e.data)!=null&&t.teams)){i(d=>h(d,n=>{n.allTeams=e.data.teams})),m(!1),M.success(s("All teams fetched successfully","bit-integrations"));return}m(!1),M.error(s("Teams for WooCommerce Memberships teams fetch failed. Please try again","bit-integrations"))}).catch(()=>m(!1))},w=(i,m)=>{m(!0),T(null,"teams_for_wc_memberships_refresh_member_roles").then(e=>{var t;if(e&&(e!=null&&e.success)&&((t=e==null?void 0:e.data)!=null&&t.roles)){i(d=>h(d,n=>{n.allMemberRoles=e.data.roles})),m(!1),M.success(s("All member roles fetched successfully","bit-integrations"));return}m(!1),M.error(s("Member roles fetch failed. Please try again","bit-integrations"))}).catch(()=>m(!1))},L=i=>!(!(i!=null&&i.selectedTeam)||["add_member_to_team","invite_user_to_team","update_member_role"].includes(i==null?void 0:i.mainAction)&&!(i!=null&&i.selectedMemberRole)||(i!=null&&i.field_map?i.field_map.filter(e=>!e.formField||!e.teamsForWooCommerceMembershipsField||e.formField==="custom"&&!e.customValue):[]).length>0),G=i=>{const m=i.filter(e=>e.required===!0);return m.length>0?m.map(e=>({formField:"",teamsForWooCommerceMembershipsField:e.key})):[{formField:"",teamsForWooCommerceMembershipsField:""}]};function B({i,formFields:m,field:e,teamsForWcConf:t,setTeamsForWcConf:d}){var g,x,_;const n=S(k),{isPro:u}=n,b=((g=t==null?void 0:t.teamsForWooCommerceMembershipsFields)==null?void 0:g.filter(a=>a.required===!0))||[],j=((x=t==null?void 0:t.teamsForWooCommerceMembershipsFields)==null?void 0:x.filter(a=>a.required===!1))||[];return l.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:l.jsxs("div",{className:"pos-rel flx",children:[l.jsxs("div",{className:"flx integ-fld-wrp",children:[l.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:a=>R(a,i,t,d),children:[l.jsx("option",{value:"",children:s("Select Field","bit-integrations")}),l.jsx("optgroup",{label:s("Form Fields","bit-integrations"),children:m==null?void 0:m.map(a=>l.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`))}),l.jsx("option",{value:"custom",children:s("Custom...","bit-integrations")}),l.jsx("optgroup",{label:$(s("General Smart Codes %s","bit-integrations"),u?"":`(${s("Pro","bit-integrations")})`),children:u&&((_=P)==null?void 0:_.map(a=>l.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`)))})]}),e.formField==="custom"&&l.jsx(U,{onChange:a=>z(a,i,t,d),label:s("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:s("Custom Value","bit-integrations"),formFields:m}),l.jsxs("select",{className:"btcd-paper-inp",disabled:i<b.length,name:"teamsForWooCommerceMembershipsField",value:i<b?b[i].label||"":e.teamsForWooCommerceMembershipsField||"",onChange:a=>R(a,i,t,d),children:[l.jsx("option",{value:"",children:s("Select Field","bit-integrations")}),i<b.length?l.jsx("option",{value:b[i].key,children:b[i].label},b[i].key):j.map(({key:a,label:o})=>l.jsx("option",{value:a,children:o},a))]})]}),i>=b.length&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>E(i,t,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),l.jsx("button",{onClick:()=>D(i,t,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:l.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}const N=[{name:"add_member_to_team",label:s("Add Member to Team","bit-integrations")},{name:"remove_member_from_team",label:s("Remove Member from Team","bit-integrations")},{name:"invite_user_to_team",label:s("Invite User to Team","bit-integrations")},{name:"update_member_role",label:s("Update Member Role","bit-integrations")}];function f({formID:i,formFields:m,teamsForWcConf:e,setTeamsForWcConf:t,isLoading:d,setIsLoading:n,setSnackbar:u}){var x,_,a,o;const b=S(k),{isPro:j}=b,g=r=>{t(p=>h(p,c=>{c.mainAction=r,c.teamsForWooCommerceMembershipsFields=[{key:"user_email",label:s("User Email","bit-integrations"),required:!0}],c.field_map=G(c.teamsForWooCommerceMembershipsFields)})),A(t,n),["add_member_to_team","invite_user_to_team","update_member_role"].includes(r)||w(t,n)};return l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:s("Action:","bit-integrations")}),l.jsx(v,{title:"mainAction",defaultValue:(x=e==null?void 0:e.mainAction)!=null?x:null,className:"mt-2 w-5",onChange:r=>g(r),options:N==null?void 0:N.map(r=>({label:y(j,r.is_pro)?r.label:q(r.label),value:r.name,disabled:!y(j,r.is_pro)})),singleSelect:!0,closeOnSelect:!0})]}),(e==null?void 0:e.mainAction)&&l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:s("Select Team:","bit-integrations")}),l.jsx(v,{title:"selectedTeam",defaultValue:(_=e==null?void 0:e.selectedTeam)!=null?_:null,className:"btcd-paper-drpdwn w-5",options:(e==null?void 0:e.allTeams)&&Array.isArray(e.allTeams)&&e.allTeams.map(r=>({label:r.team_name,value:r.team_id.toString()})),onChange:r=>t(p=>h(p,c=>{c.selectedTeam=r})),singleSelect:!0,closeOnSelect:!0}),l.jsx("button",{onClick:()=>A(t,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${s("Refresh Teams","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]})]}),["add_member_to_team","invite_user_to_team","update_member_role"].includes(e==null?void 0:e.mainAction)&&l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:s("Member Role:","bit-integrations")}),l.jsx(v,{title:"selectedMemberRole",defaultValue:(a=e==null?void 0:e.selectedMemberRole)!=null?a:null,className:"btcd-paper-drpdwn w-5",options:(e==null?void 0:e.allMemberRoles)&&Array.isArray(e.allMemberRoles)&&e.allMemberRoles.map(r=>({label:r.label,value:r.value})),onChange:r=>t(p=>h(p,c=>{c.selectedMemberRole=r})),singleSelect:!0,closeOnSelect:!0}),l.jsx("button",{onClick:()=>w(t,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${s("Refresh Member Roles","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]})]}),d&&l.jsx(V,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(e==null?void 0:e.mainAction)&&e.teamsForWooCommerceMembershipsFields&&l.jsxs("div",{className:"mt-4",children:[l.jsx("b",{className:"wdt-100",children:s("Map Fields","bit-integrations")}),l.jsx("div",{className:"btcd-hr mt-1"}),l.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[l.jsx("div",{className:"txt-dp",children:l.jsx("b",{children:s("Form Fields","bit-integrations")})}),l.jsx("div",{className:"txt-dp",children:l.jsx("b",{children:s("Teams for WooCommerce Memberships Fields","bit-integrations")})})]}),(o=e==null?void 0:e.field_map)==null?void 0:o.map((r,p)=>l.jsx(B,{i:p,field:r,teamsForWcConf:e,formFields:m,setTeamsForWcConf:t},`teams-wc-m-${p+9}`)),l.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:l.jsx("button",{onClick:()=>O(e.field_map.length,e,t),className:"icn-btn sh-sm",type:"button",children:"+"})}),l.jsx("br",{})]})]})}export{f as T,L as c,I as h};
