var L=Object.defineProperty;var _=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var w=(t,i,l)=>i in t?L(t,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[i]=l,x=(t,i)=>{for(var l in i||(i={}))S.call(i,l)&&w(t,l,i[l]);if(_)for(var l of _(i))M.call(i,l)&&w(t,l,i[l]);return t};import{k as o,g as N,j as e,_ as r,L as T}from"./main.2.7.8.js";import{a as g,d as $,g as A,b as V}from"./KlaviyoCommonFunc.B3ZI7eTG.js";import{a as q,h as R}from"./Integrations.DsKoVZo5.js";import{T as U}from"./TagifyInput.AWOXl6wg.js";import"./Note.CbpnsFnB.js";import{b as B}from"./Table.PPpIxK2a.js";import{a as E,P as I}from"./ActionProFeatureLabels.D9cDQ8Dg.js";import{A as G}from"./ActionProFeatureComponent.CK2UJbyQ.js";function P({i:t,field:i,formFields:l,klaviyoConf:n,setKlaviyoConf:m,type:p}){var d;const h=o(N),{isPro:b}=h,c=(n==null?void 0:n.klaviyoFields.filter(s=>s.required===!0))||[],u=(n==null?void 0:n.klaviyoFields.filter(s=>s.required===!1))||[],a=(s,j)=>{const F=x({},n);F[p][j][s.target.name]=s.target.value,m(F)};return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",onChange:s=>{a(s,t)},value:i.formField||"",children:[e.jsx("option",{value:"",children:r("Select Field","bit-integrations")}),e.jsx("optgroup",{label:r("Form Fields","bit-integrations"),children:l==null?void 0:l.map(s=>e.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`))}),e.jsx("option",{value:"custom",children:r("Custom...","bit-integrations")}),e.jsx("optgroup",{label:sprintf(r("General Smart Codes %s","bit-integrations"),b?"":`(${r("Pro","bit-integrations")})`),children:b&&((d=q)==null?void 0:d.map(s=>e.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`)))})]}),i.formField==="custom"&&e.jsx(U,{onChange:s=>R(s,t),label:r("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:i.customValue,placeholder:r("Custom Value","bit-integrations"),formFields:l}),p==="field_map"?e.jsxs("select",{className:"btcd-paper-inp",disabled:t<c.length,name:"klaviyoFormField",onChange:s=>{a(s,t)},value:t<c.length?c[t].key||"":i.klaviyoFormField||"",children:[e.jsx("option",{value:"",children:r("Select Field","bit-integrations")}),t<c.length?e.jsx("option",{value:c[t].key,children:c[t].label},c[t].key):u.map(({key:s,label:j})=>e.jsx("option",{value:s,children:j},s))]}):e.jsx("input",{className:"btcd-paper-inp",name:"klaviyoFormField",value:i.klaviyoFormField||"",onChange:s=>{a(s,t)},type:"text"})]}),e.jsx("button",{onClick:()=>g(t,n,m,p),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>$(t,n,m,p),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})})}function H({klaviyoConf:t,setKlaviyoConf:i,loading:l,setLoading:n}){const m=o(N),{isPro:p}=m,h=(b,c)=>{var a;const u=x({},t);(a=b.target)!=null&&a.checked?u.update=!0:delete u.update,i(x({},u))};return e.jsx("div",{className:"pos-rel d-flx w-8",children:e.jsx(B,{checked:(t==null?void 0:t.update)||!1,onChange:b=>h(b),className:"wdt-200 mt-4 mr-2",value:"update",isInfo:!p,title:e.jsx(I,{title:r("Update Profile","bit-integrations")}),subTitle:e.jsx(E,{title:r("Update Profile","bit-integrations"),subtitle:r("A record gets updated based on the email, else a new profile will be created","bit-integrations"),proVersion:"2.4.9"})})})}function K({klaviyoConf:t,setKlaviyoConf:i,formFields:l,loading:n,setLoading:m}){var c,u;const p=o(N),{isPro:h}=p,b=a=>{const d=x({},t),{name:s}=a.target;a.target.value!==""?d[s]=a.target.value:delete d[s],d[a.target.name]=a.target.value,a.target.name==="listId"&&(d.field_map=V(d),d.custom_field_map=[{formField:"",klaviyoFormField:""}]),i(x({},d))};return e.jsxs("div",{children:[e.jsx("b",{className:"wdt-200 d-in-b mt-2",children:r("List:","bit-integrations")}),e.jsxs("select",{name:"listId",value:t.listId,onChange:b,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:r("Select List","bit-integrations")}),((c=t==null?void 0:t.default)==null?void 0:c.lists)&&t.default.lists.map((a,d)=>{var s;return e.jsx("option",{value:a==null?void 0:a.id,children:(s=a==null?void 0:a.attributes)==null?void 0:s.name},d)})]}),e.jsx("button",{onClick:()=>A(t,i,n,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh list"'},type:"button",disabled:n.list,children:"â†»"}),n.list&&e.jsx(T,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(t==null?void 0:t.listId)&&e.jsxs("div",{className:"mt-5",children:[e.jsx("b",{className:"wdt-100",children:r("Field Map","bit-integrations")}),e.jsx("div",{className:"btcd-hr mt-2 mb-4"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Klaviyo Fields","bit-integrations")})})]}),t==null?void 0:t.field_map.map((a,d)=>e.jsx(P,{i:d,field:a,formFields:l,klaviyoConf:t,setKlaviyoConf:i,type:"field_map"},`ko-m-${d+8}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g(t.field_map.length,t,i,"field_map"),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsx("br",{}),(t==null?void 0:t.listId)&&e.jsxs("div",{className:"mt-5",children:[e.jsxs(G,{title:r("Custom Properties","bit-integrations"),children:[e.jsx("b",{className:"wdt-100",children:e.jsx(I,{title:r("Custom Properties","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-2 mb-4"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Klaviyo Property name","bit-integrations")})})]}),(u=t==null?void 0:t.custom_field_map)==null?void 0:u.map((a,d)=>e.jsx(P,{i:d,field:a,formFields:l,klaviyoConf:t,setKlaviyoConf:i,type:"custom_field_map"},`ko-m-${d+8}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>{var a;return g((a=t==null?void 0:t.custom_field_map)==null?void 0:a.length,t,i,"custom_field_map")},className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:r("Utilities","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(H,{klaviyoConf:t,setKlaviyoConf:i,formFields:l,loading:n,setLoading:m})]})]})}export{K};
