var M=Object.defineProperty,T=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var F=(e,i,a)=>i in e?M(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,l=(e,i)=>{for(var a in i||(i={}))$.call(i,a)&&F(e,a,i[a]);if(h)for(var a of h(i))V.call(i,a)&&F(e,a,i[a]);return e},p=(e,i)=>T(e,w(i));var b=(e,i,a)=>new Promise((s,t)=>{var o=n=>{try{r(a.next(n))}catch(c){t(c)}},d=n=>{try{r(a.throw(n))}catch(c){t(c)}},r=n=>n.done?s(n.value):Promise.resolve(n.value).then(o,d);r((a=a.apply(e,i)).next())});import{_ as u,d as v}from"./main.2.7.10.js";const E=(e,i,a)=>{const{name:s,value:t}=e.target;a(o=>p(l({},o),{[s]:t}))},G=(e,i,a,s,t,o)=>b(null,null,function*(){var d;if(!e.accessToken){a({accessToken:u("Access Token can't be empty","bit-integrations")});return}a({}),t(!0);try{const r=yield v({accessToken:e.accessToken},"line_authorization");if(r!=null&&r.success)i(p(l({},e),{tokenDetails:r.data})),s(!0),o({show:!0,msg:u("Authorized Successfully","bit-integrations")});else{const n=(d=r==null?void 0:r.data)!=null&&d.data?`${u("Authorization failed Cause:","bit-integrations")} ${r.data.data}. ${u("Please try again","bit-integrations")}`:typeof(r==null?void 0:r.data)=="string"?`${u("Authorization failed Cause:","bit-integrations")} ${r.data}. ${u("Please try again","bit-integrations")}`:u("Authorization failed. Please try again","bit-integrations");o({show:!0,msg:n})}t(!1)}catch(r){o({show:!0,msg:`${u("An error occurred during authorization:","bit-integrations")} ${(r==null?void 0:r.message)||r}`}),t(!1)}}),A=(e,i,a,s)=>{const t=l({},e);return Array.isArray(t[i])||(t[i]=[]),t[i][a]||(t[i][a]={}),t[i][a]=l(l({},t[i][a]),s(t[i][a])),t},P=(e,i,a,s)=>{const t=()=>l({[e.target.name]:e.target.value},e.target.value==="custom"?{customValue:""}:{customValue:void 0});a(o=>A(o,s,i,t))},R=(e,i,a,s,t)=>{var d,r;const o=(r=(d=e==null?void 0:e.target)==null?void 0:d.value)!=null?r:e;s(n=>A(n,t,i,()=>({customValue:o})))},S=(e,i,a,s)=>{a(t=>{var r;const o=t[s]||[];if(o.length<=1)return t;const d=(r=o[e])!=null&&r.groupId?o.filter(n=>n.groupId!==o[e].groupId):o.filter((n,c)=>c!==e);return p(l({},t),{[s]:d})})},j={sticker:["sticker_id","package_id"],image:["originalContentUrl","previewImageUrl"],audio:["originalContentUrl","duration"],video:["originalContentUrl","previewImageUrl"],location:["title","address","latitude","longitude"],emoji:["emojis_id","product_id","index"]},f=e=>{for(const[i,a]of Object.entries(j))if(a.includes(e))return i;return"default"},k=(e,i)=>{if(e==="audio")return`audio_${[...new Set(i.filter(t=>t.fieldType==="audio").map(t=>t.groupId))].length+1}`;const a=[...new Set(i.filter(s=>f(s.lineFormField)===e).map(s=>s.groupId))];return`${e}_${a.length+1}`},U=(e,i,a,s,t)=>{a(o=>{const d=l({},o);if(Array.isArray(d[t])||(d[t]=[]),t==="audio_field_map"){const _=k("audio",d[t]),I=s.map(y=>({formField:"",lineFormField:y.value,groupId:_,fieldType:"audio"}));return d[t].splice(e,0,...I),d}let r=f(s[0].value),n=k(r,d[t]);const c=s.map(_=>({formField:"",lineFormField:_.value,groupId:n,fieldType:r}));return d[t].splice(e,0,...c),d})},g=e=>Array.isArray(e)&&e.length>0&&e.every(i=>{var a,s;return i&&(i.formField!=="custom"?(a=i.formField)==null?void 0:a.trim():(s=i.customValue)==null?void 0:s.trim())}),m=e=>{var i,a,s;return((i=e.message_field_map)==null?void 0:i[0])&&(e.message_field_map[0].formField!=="custom"?(a=e.message_field_map[0].formField)==null?void 0:a.trim():(s=e.message_field_map[0].customValue)==null?void 0:s.trim())},L=e=>{var s,t;let i=!1;switch(e.messageType){case"sendPushMessage":i=((s=e.recipientId)==null?void 0:s.trim())&&m(e);break;case"sendReplyMessage":i=((t=e.replyToken)==null?void 0:t.trim())&&m(e);break;case"sendBroadcastMessage":i=m(e);break}const a=[!e.sendEmojis||g(e.emojis_field_map),!e.sendSticker||g(e.sticker_field_map),!e.sendImage||g(e.image_field_map),!e.sendAudio||g(e.audio_field_map),!e.sendVideo||g(e.video_field_map),!e.sendLocation||g(e.location_field_map)].every(Boolean);return i&&a},B=e=>{var s,t;const i=[],a=[["sendEmojis","emojis_field_map","Emojis"],["sendSticker","sticker_field_map","Sticker"],["sendImage","image_field_map","Image"],["sendAudio","audio_field_map","Audio"],["sendVideo","video_field_map","Video"],["sendLocation","location_field_map","Location"]];switch(e.messageType){case"sendPushMessage":(s=e.recipientId)!=null&&s.trim()||i.push(u("Recipient ID is required","bit-integrations")),m(e)||i.push(u("Message field mapping is required","bit-integrations"));break;case"sendReplyMessage":(t=e.replyToken)!=null&&t.trim()||i.push(u("Reply Token is required","bit-integrations")),m(e)||i.push(u("Message field mapping is required","bit-integrations"));break;case"sendBroadcastMessage":m(e)||i.push(u("Message field mapping is required","bit-integrations"));break;default:i.push(u("Please select a message type","bit-integrations"))}return a.forEach(([o,d,r])=>{e[o]&&!g(e[d])&&i.push(`${r} field mapping is required`)}),i},D=(e,i=null)=>{const a=e.filter(s=>s.required);if(a.length){const s={};return a.map(t=>{const o=i||f(t.value);return s[o]||(s[o]=`${o}_1`),{formField:"",lineFormField:t.value,groupId:s[o],fieldType:o}})}return[{formField:"",lineFormField:""}]};export{P as a,R as b,U as c,S as d,G as e,B as f,D as g,E as h,L as v};
