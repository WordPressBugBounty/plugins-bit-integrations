var p=Object.defineProperty;var G=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var H=(e,n,l)=>n in e?p(e,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[n]=l,b=(e,n)=>{for(var l in n||(n={}))M.call(n,l)&&H(e,l,n[l]);if(G)for(var l of G(n))R.call(n,l)&&H(e,l,n[l]);return e};import{r as C,j as t,L as F,f as tt}from"./main-458.js";import{x as w}from"./bi.413.449.js";import{_ as i,d as et}from"./bi.10.0.js";import{a as v}from"./bi.271.9.js";import{b as S}from"./bi.125.11.js";import{g as Y,a as z,b as D,d as J,e as Q,f as st,i as W,j as X,k as Z}from"./bi.841.921.js";import{M as lt,a as it}from"./bi.698.3.js";import{T as at}from"./bi.64.739.js";function nt({copperCRMConf:e,setCopperCRMConf:n,loading:l,setLoading:s}){var u,r,d,k,P,T,O,A,_,V;const[m,c]=C.useState({show:!1,action:()=>{}}),g=[{label:i("Yes","bit-integrations"),value:"yes"},{label:i("No","bit-integrations"),value:"no"}],o=[{label:i("New Business","bit-integrations"),value:"New Business"},{label:i("Existing Business","bit-integrations"),value:"Existing Business"}],N=(a,y)=>{var $,I,K,U,q,B,E;const x=b({},e);y==="opportunity"?($=a.target)!=null&&$.checked?(Y(e,n,s),x.actions.opportunity=!0):(c({show:!1}),delete x.actions.opportunity):y==="owner"?(I=a.target)!=null&&I.checked?(z(e,n,s),x.actions.owner=!0):(c({show:!1}),delete x.actions.owner):y==="company"?(K=a.target)!=null&&K.checked?(D(e,n,s),x.actions.company=!0):(c({show:!1}),delete x.actions.company):y==="tag"?(U=a.target)!=null&&U.checked?(J(e,n,s),x.actions.tag=!0):(c({show:!1}),delete x.actions.tag):y==="pipelineStage"?(q=a.target)!=null&&q.checked?(Q(e,n,s),x.actions.pipelineStage=!0):(c({show:!1}),delete x.actions.pipelineStage):y==="followUp"?(B=a.target)!=null&&B.checked?x.actions.followUp=!0:(c({show:!1}),delete x.actions.followUp):y==="opportunityType"&&((E=a.target)!=null&&E.checked?x.actions.opportunityType=!0:(c({show:!1}),delete x.actions.opportunityType)),c({show:y}),n(b({},x))},h=()=>{c({show:!1})},j=(a,y)=>{const x=b({},e);x[y]=a,n(b({},x))};return t.jsxs("div",{className:"pos-rel d-flx flx-wrp",children:[e.actionName==="person"&&t.jsxs(t.Fragment,{children:[t.jsx(S,{checked:((u=e==null?void 0:e.selectedCompany)==null?void 0:u.length)||!1,onChange:a=>N(a,"company"),className:"wdt-200 mt-4 mr-2",value:"company",title:i("Add Company","bit-integrations"),subTitle:i("Add an company")}),t.jsx(S,{checked:((r=e==null?void 0:e.selectedTags)==null?void 0:r.length)||!1,onChange:a=>N(a,"tag"),className:"wdt-200 mt-4 mr-2",value:"tag",title:i("Add Tags","bit-integrations"),subTitle:i("Add tags")})]}),(e.actionName==="person"||e.actionName==="company"||e.actionName==="opportunity"||e.actionName==="task")&&t.jsx(S,{checked:((d=e==null?void 0:e.selectedOwner)==null?void 0:d.length)||!1,onChange:a=>N(a,"owner"),className:"wdt-200 mt-4 mr-2",value:"owner",title:i("Add Owner","bit-integrations"),subTitle:i("Add an owner")}),e.actionName==="opportunity"&&t.jsx(S,{checked:((k=e==null?void 0:e.selectedCompany)==null?void 0:k.length)||!1,onChange:a=>N(a,"company"),className:"wdt-200 mt-4 mr-2",value:"company",title:i("Add Company","bit-integrations"),subTitle:i("Add an company")}),e.actionName==="opportunity"&&t.jsx(S,{checked:((P=e==null?void 0:e.selectedPipelineStage)==null?void 0:P.length)||!1,onChange:a=>N(a,"pipelineStage"),className:"wdt-200 mt-4 mr-2",value:"pipelineStage",title:i("Add PipelineStage","bit-integrations"),subTitle:i("Add a pipelineStage")}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="opportunity",close:h,action:h,title:i("Opportunities","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select Opportunity","bit-integrations")}),l.opportunities?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(w,{options:(T=e==null?void 0:e.opportunities)==null?void 0:T.map(a=>({label:a.name,value:a.id})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedOpportunity,onChange:a=>j(a,"selectedOpportunity"),singleSelect:!0}),t.jsx("button",{onClick:()=>Y(e,n,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh Opportunities","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="owner",close:h,action:h,title:i("Owners","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select Owner","bit-integrations")}),l.owners?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(w,{options:(O=e==null?void 0:e.owners)==null?void 0:O.map(a=>({label:a.name,value:a.id})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedOwner,onChange:a=>j(a,"selectedOwner"),singleSelect:!0}),t.jsx("button",{onClick:()=>z(e,n,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh Owners","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="company",close:h,action:h,title:i("Companies","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select Company","bit-integrations")}),l.companies?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(w,{options:(A=e==null?void 0:e.companies)==null?void 0:A.map(a=>({label:a.name,value:a.id})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedCompany,onChange:a=>j(a,"selectedCompany"),singleSelect:!0}),t.jsx("button",{onClick:()=>D(e,n,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh Companies","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="tag",close:h,action:h,title:i("Companies","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select tags","bit-integrations")}),l.tags?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(w,{options:(_=e==null?void 0:e.tags)==null?void 0:_.map(a=>({label:a,value:a})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedTags,onChange:a=>j(a,"selectedTags")}),t.jsx("button",{onClick:()=>J(e,n,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh Tags","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="pipelineStage",close:h,action:h,title:i("PipelineStages","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select PipelineStage","bit-integrations")}),l.pipelineStages?t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(w,{options:(V=e==null?void 0:e.pipelineStages)==null?void 0:V.map(a=>({label:a.name,value:a.id})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedPipelineStage,onChange:a=>j(a,"selectedPipelineStage"),singleSelect:!0}),t.jsx("button",{onClick:()=>Q(e,n,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh PipelineStages","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="followUp",close:h,action:h,title:i("Follow Up","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"flx flx-center mt-2",children:t.jsx(w,{options:g==null?void 0:g.map(a=>({label:a.label,value:a.value})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedFollowUp,onChange:a=>j(a,"selectedFollowUp"),singleSelect:!0})})]}),t.jsxs(v,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:i("Ok","bit-integrations"),show:m.show==="opportunityType",close:h,action:h,title:i("Opportunity types","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"flx flx-center mt-2",children:t.jsx(w,{options:o==null?void 0:o.map(a=>({label:a.label,value:a.value})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedOpportunityType,onChange:a=>j(a,"selectedOpportunityType"),singleSelect:!0})})]})]})}const f=(e,n,l)=>{const s=b({},n);s.field_map.splice(e,0,{}),l(b({},s))},mt=(e,n,l)=>{const s=b({},n);s.field_map.length>1&&s.field_map.splice(e,1),l(b({},s))},L=(e,n,l,s)=>{const m=b({},l);m.field_map[n][e.target.name]=e.target.value,e.target.value==="custom"&&(m.field_map[n].customValue=""),e.target.value==="customFieldKey"&&(m.field_map[n].customFieldKey=""),s(b({},m))},dt=(e,n,l,s)=>{const m=b({},l);m.field_map[n].customValue=e.target.value,s(b({},m))},ct=(e,n,l,s,m)=>{const c=b({},l);c.field_map[n][m]=e.target.value,s(b({},c))};function ut({field:e,index:n,conf:l,setConf:s,fieldValue:m,fieldLabel:c,className:g}){return t.jsx(lt,{onChange:o=>ct(o,n,l,s,m),label:i(c,"bit-integrations"),className:g,type:"text",value:e[m],placeholder:i(c,"bit-integrations")})}function bt({i:e,formFields:n,field:l,copperCRMConf:s,setCopperCRMConf:m}){var u,r;let c=[];s.actionName==="company"?c=s==null?void 0:s.companyFields:s.actionName==="person"?c=s==null?void 0:s.personFields:s.actionName==="opportunity"?c=s==null?void 0:s.opportunityFields:s.actionName==="task"&&(c=s==null?void 0:s.taskFields);const g=c.filter(d=>d.required===!0)||[],o=c.filter(d=>d.required===!1)||[],N=s.customFields?[...o,...s==null?void 0:s.customFields]:o;if(((u=s==null?void 0:s.field_map)==null?void 0:u.length)===1&&l.coppercrmFormField===""){const d=b({},s),k=st(d);d.field_map=k,m(d)}const h=tt(et),{isPro:j}=h;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:l.formField||"",onChange:d=>L(d,e,s,m),children:[t.jsx("option",{value:"",children:i("Select Field","bit-integrations")}),t.jsx("optgroup",{label:i("Form Fields","bit-integrations"),children:n==null?void 0:n.map(d=>t.jsx("option",{value:d.name,children:d.label},`ff-rm-${d.name}`))}),t.jsx("option",{value:"custom",children:i("Custom...","bit-integrations")}),t.jsx("optgroup",{label:sprintf(i("General Smart Codes %s","bit-integrations"),j?"":`(${i("Pro","bit-integrations")})`),children:j&&((r=it)==null?void 0:r.map(d=>t.jsx("option",{value:d.name,children:d.label},`ff-rm-${d.name}`)))})]}),l.formField==="custom"&&t.jsx(at,{onChange:d=>dt(d,e,s,m),label:i("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:l.customValue,placeholder:i("Custom Value","bit-integrations"),formFields:n}),t.jsxs("select",{className:"btcd-paper-inp",disabled:e<g.length,name:"coppercrmFormField",value:e<g?g[e].label||"":l.coppercrmFormField||"",onChange:d=>L(d,e,s,m),children:[t.jsx("option",{value:"",children:i("Select Field","bit-integrations")}),e<g.length?t.jsx("option",{value:g[e].key,children:g[e].label},g[e].key):N.map(({key:d,label:k})=>t.jsx("option",{value:d,children:k},d)),(s.actionName==="company"||s.actionName==="person"||s.actionName==="opportunity"||s.actionName==="task")&&t.jsx("option",{value:"customFieldKey",children:i("Custom Field","bit-integrations")})]}),l.coppercrmFormField==="customFieldKey"&&t.jsx(ut,{field:l,index:e,conf:s,setConf:m,fieldValue:"customFieldKey",fieldLabel:"Custom Field Key",className:"ml-2"})]}),e>=g.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>f(e,s,m),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>mt(e,s,m),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function vt({formFields:e,handleInput:n,copperCRMConf:l,setCopperCRMConf:s,loading:m,setLoading:c,setSnackbar:g}){var h,j;const o=u=>{const r=b({},l);r.field_map=[{formField:"",coppercrmFormField:""}];const{name:d}=u.target;u.target.value!==""?(r[d]=u.target.value,Z(r,s,c),u.target.value==="opportunity"&&W(r,s,c)):delete r[d],s(b({},r))},N=(u,r)=>{const d=b({},l);d[r]=u,r==="selectedCRMPeople"&&u!==""&&l.actionName==="opportunity"&&(d.selectedCRMPipelines="",X(d,s,c)),s(b({},d))};return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:i("Select Action:","bit-integrations")}),t.jsxs("select",{onChange:o,name:"actionName",value:l.actionName,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:i("Select an action","bit-integrations")}),t.jsx("option",{value:"company",children:i("Create Company","bit-integrations")}),t.jsx("option",{value:"person",children:i("Create Person","bit-integrations")}),t.jsx("option",{value:"opportunity",children:i("Create Opportunity","bit-integrations")}),t.jsx("option",{value:"task",children:i("Create Task","bit-integrations")})]}),(m.CRMPeoples||m.CRMPipelines)&&t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),l.actionName==="opportunity"&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:i("Select People:","bit-integrations")}),t.jsx(w,{options:(h=l==null?void 0:l.CRMPeoples)==null?void 0:h.map(u=>({label:u.name,value:u.id})),className:"msl-wrp-options dropdown-custom-width",defaultValue:l==null?void 0:l.selectedCRMPeople,onChange:u=>N(u,"selectedCRMPeople"),disabled:m.CRMPeoples,singleSelect:!0}),t.jsx("button",{onClick:()=>W(l,s,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh peoples","bit-integrations")}'`},type:"button",disabled:m.CRMPeoples,children:"↻"})]})]}),l.actionName==="opportunity"&&l.selectedCRMPeople&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:i("Select Pipeline:","bit-integrations")}),t.jsx(w,{options:(j=l==null?void 0:l.CRMPipelines)==null?void 0:j.map(u=>({label:u.name,value:u.id})),className:"msl-wrp-options dropdown-custom-width",defaultValue:l==null?void 0:l.selectedCRMPipelines,onChange:u=>N(u,"selectedCRMPipelines"),disabled:m.CRMPipelines,singleSelect:!0}),t.jsx("button",{onClick:()=>X(l,s,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh pipelines","bit-integrations")}'`},type:"button",disabled:m.CRMPipelines,children:"↻"})]})]}),m.customFields&&t.jsx(F,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),l.actionName&&t.jsxs("div",{children:[t.jsx("br",{}),t.jsxs("div",{className:"mt-5",children:[t.jsx("b",{className:"wdt-100",children:i("Field Map","bit-integrations")}),t.jsx("button",{onClick:()=>Z(l,s,c),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh fields","bit-integrations")}'`},type:"button",disabled:m.CRMPipelines,children:"↻"})]}),t.jsx("br",{}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:i("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:i("CopperCRM Fields","bit-integrations")})})]}),l==null?void 0:l.field_map.map((u,r)=>t.jsx(bt,{i:r,field:u,copperCRMConf:l,formFields:e,setCopperCRMConf:s,setSnackbar:g},`rp-m-${r+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>f(l.field_map.length,l,s),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:i("Utilities","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(nt,{copperCRMConf:l,setCopperCRMConf:s,formFields:e,loading:m,setLoading:c})]})]})}export{vt as C};
