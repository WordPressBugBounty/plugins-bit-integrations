var T=Object.defineProperty;var w=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var f=(a,r,e)=>r in a?T(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e,u=(a,r)=>{for(var e in r||(r={}))V.call(r,e)&&f(a,e,r[e]);if(w)for(var e of w(r))k.call(r,e)&&f(a,e,r[e]);return a};import{f as A,j as s,r as N,L as P}from"./main-388.js";import{x as M}from"./bi.803.443.js";import{d as $,_ as l}from"./bi.576.0.js";import{a as E}from"./bi.160.3.js";import{T as L}from"./bi.691.720.js";import{a as R}from"./bi.578.9.js";import{b as I}from"./bi.280.11.js";import{g as y}from"./bi.517.718.js";import{A as U}from"./bi.342.722.js";import{P as B}from"./bi.108.723.js";const v=(a,r,e,i="field_map")=>{const c=u({},r);c[i]||(c[i]=[]),c[i].splice(a,0,{}),e(u({},c))},G=(a,r,e,i="field_map")=>{const c=u({},r);c[i].length>1&&c[i].splice(a,1),e(u({},c))},H=(a,r,e,i,c="field_map")=>{var h;const d=u({},e);d[c][r].customValue=((h=a==null?void 0:a.target)==null?void 0:h.value)||a,i(u({},d))},j=(a,r,e,i,c="field_map")=>{const d=u({},e);d[c][r][a.target.name]=a.target.value,a.target.value==="custom"&&(d[c][r].customValue=""),i(u({},d))};function q({i:a,formFields:r,field:e,omniSendConf:i,setOmniSendConf:c,type:d}){var m;const h=A($),{isPro:x}=h,b=(i==null?void 0:i.omniSend_fields.filter(t=>t.required===!0))||[],p=(i==null?void 0:i.omniSend_fields.filter(t=>t.required===!1))||[];return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:t=>j(t,a,i,c,d),children:[s.jsx("option",{value:"",children:l("Select Field","bit-integrations")}),s.jsx("optgroup",{label:l("Form Fields","bit-integrations"),children:r==null?void 0:r.map(t=>s.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`))}),s.jsx("option",{value:"custom",children:l("Custom...","bit-integrations")}),s.jsx("optgroup",{label:sprintf(l("General Smart Codes %s","bit-integrations"),x?"":`(${l("Pro","bit-integrations")})`),children:x&&((m=E)==null?void 0:m.map(t=>s.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`)))})]}),e.formField==="custom"&&s.jsx(L,{onChange:t=>H(t,a,i,c,d),label:l("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:l("Custom Value","bit-integrations"),formFields:r}),d==="field_map"?s.jsxs("select",{className:"btcd-paper-inp",disabled:a<b.length,name:"omniSendFormField",value:a<b?b[a].label||"":e.omniSendFormField||"",onChange:t=>j(t,a,i,c,d),children:[s.jsx("option",{value:"",children:l("Select Field","bit-integrations")}),a<b.length?s.jsx("option",{value:b[a].key,children:b[a].label},b[a].key):p.map(({key:t,label:n})=>s.jsx("option",{value:t,children:n},t))]}):s.jsx("input",{className:"btcd-paper-inp",name:"omniSendFormField",value:e.omniSendFormField||"",onChange:t=>j(t,a,i,c,d),type:"text"})]}),a>=b.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>v(a,i,c,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>G(a,i,c,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function z({omniSendConf:a,setOmniSendConf:r,formFields:e,loading:i,setLoading:c}){const[d,h]=N.useState({show:!1,action:()=>{}}),x=(m,t)=>{const n=u({},a);t==="tag"&&(m.target.checked?n.actions.tag=!0:delete n.actions.tag,h({show:t})),r(u({},n))},b=()=>{h({show:!1})},p=(m,t)=>{const n=u({},a);t==="selected_tags"&&m.length?n.actions.selected_tags=!0:t==="selected_tags"&&m.length<1&&delete n.actions.selected_tags,n[t]=m,r(u({},n))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"pos-rel d-flx w-8",children:s.jsx(I,{checked:(a==null?void 0:a.actions.tag)||!1,onChange:m=>x(m,"tag"),className:"wdt-200 mt-4 mr-2",value:"tags",title:l("Tags","bit-integrations"),subTitle:l("Add Custom Tags","bit-integrations")})}),s.jsxs(R,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:l("Ok","bit-integrations"),show:d.show==="tag",close:b,action:b,title:l("Add Custom Tags","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsx("div",{className:"flx flx-between mt-2",children:s.jsx(M,{className:"msl-wrp-options",defaultValue:a==null?void 0:a.selected_tags,options:[],onChange:m=>p(m,"selected_tags"),customValue:!0})})]})]})}function ss({formFields:a,handleInput:r,omniSendConf:e,setOmniSendConf:i,loading:c,setLoading:d,setSnackbar:h}){var m;const x=N.useRef(!0),b=[{label:l("Email","bit-integrations"),value:"email"},{label:l("SMS","bit-integrations"),value:"sms"}],p=(t,n)=>{const _=t.search("email"),F=t.search("sms"),g=u({},e),o=g.omniSend_fields;t.length?(g.actions.channel=!0,_!==-1&&F!==-1?(o[0].required=!0,o[1].required=!0):_!==-1?(o[0].required=!0,o[1].required=!1):F!==-1?(o[1].required=!0,o[0].required=!1):(o[0].required=!1,o[1].required=!1)):(delete g.actions.channel,o[0].required=!1,o[1].required=!1),g[n]=t,i(u({},g))};return N.useEffect(()=>{if(x.current)x.current=!1;else{const t=u({},e),n=y(t);t.field_map=n,i(t)}},[e.channels]),s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:l("Channels","bit-integrations")}),s.jsx(M,{className:"msl-wrp-options  w-5",defaultValue:e==null?void 0:e.channels,options:b==null?void 0:b.map(t=>({label:t.label,value:t.value})),onChange:t=>p(t,"channels"),customValue:!0})]}),s.jsx("br",{}),e.channels.search("email")!==-1&&s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:l("Email Status:","bit-integrations")}),s.jsxs("select",{onChange:r,name:"email_status",value:e.email_status,className:"btcd-paper-inp w-5",required:!0,children:[s.jsx("option",{value:"",children:l("Select Status","bit-integrations")}),s.jsx("option",{value:"subscribed",children:l("Subscribed","bit-integrations")}),s.jsx("option",{value:"unsubscribed",children:l("Unsubscribed","bit-integrations")}),s.jsx("option",{value:"nonSubscribed",children:l("nonSubscribed","bit-integrations")})]})]}),s.jsx("br",{}),e.channels.search("sms")!==-1&&s.jsxs("div",{className:"flx",children:[s.jsx("b",{className:"wdt-200 d-in-b",children:l("SMS Status:","bit-integrations")}),s.jsxs("select",{onChange:r,name:"sms_status",value:e.sms_status,className:"btcd-paper-inp w-5",required:!0,children:[s.jsx("option",{value:"",children:l("Select Status","bit-integrations")}),s.jsx("option",{value:"subscribed",children:l("Subscribed","bit-integrations")}),s.jsx("option",{value:"unsubscribed",children:l("Unsubscribed","bit-integrations")}),s.jsx("option",{value:"nonSubscribed",children:l("nonSubscribed","bit-integrations")})]})]}),(e.channels.search("email")!==-1||e.channels.search("sms")!==-1)&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("div",{className:"mt-5",children:s.jsx("b",{className:"wdt-100",children:l("Field Map","bit-integrations")})}),s.jsx("br",{}),c.field&&s.jsx(P,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("OmniSend Fields","bit-integrations")})})]}),e==null?void 0:e.field_map.map((t,n)=>s.jsx(q,{i:n,field:t,omniSendConf:e,formFields:a,setOmniSendConf:i,setSnackbar:h,type:"field_map"},`rp-m-${n+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>v(e.field_map.length,e,i,"field_map"),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsxs(U,{title:l("Custom Properties","bit-integrations"),children:[s.jsx("b",{className:"wdt-100",children:s.jsx(B,{title:l("Custom Properties","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-2 mb-4"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:l("OmniSend Property name","bit-integrations")})})]}),(m=e==null?void 0:e.custom_field_map)==null?void 0:m.map((t,n)=>s.jsx(q,{i:n,field:t,omniSendConf:e,formFields:a,setOmniSendConf:i,setSnackbar:h,type:"custom_field_map"},`rp-m-${n+9}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>{var t;return v((t=e==null?void 0:e.custom_field_map)==null?void 0:t.length,e,i,"custom_field_map")},className:"icn-btn sh-sm",type:"button",children:"+"})})]}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:l("Actions","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(z,{omniSendConf:e,setOmniSendConf:i,formFields:a,loading:c,setLoading:d})]})]})}export{ss as O};
