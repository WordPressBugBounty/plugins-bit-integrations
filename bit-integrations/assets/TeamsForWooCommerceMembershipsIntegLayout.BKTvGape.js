import{d as w,z as M,_ as a,k,g as T,j as l,s as V,L as $}from"./main.2.7.11.js";import{u as h,x as v}from"./Note.iI4FM_zT.js";import{c as y,g as q}from"./ProUtilHelpers.FI856dl7.js";import{a as P,b as O}from"./Integrations.CiiC6YXN.js";import{T as U}from"./TagifyInput.ey_dUHW4.js";import{h as R,a as z,b as E,d as D}from"./GlobalIntegrationHelper.BTM-LV1r.js";const Z=(i,m,e)=>{const{name:t,value:d}=i.target;e(n=>h(n,u=>{u[t]=d}))},A=(i,m)=>{m(!0),w(null,"teams_for_wc_memberships_refresh_teams").then(e=>{var t;if(e&&(e!=null&&e.success)&&((t=e==null?void 0:e.data)!=null&&t.teams)){i(d=>h(d,n=>{n.allTeams=e.data.teams})),m(!1),M.success(a("All teams fetched successfully","bit-integrations"));return}m(!1),M.error(a("Teams for WooCommerce Memberships teams fetch failed. Please try again","bit-integrations"))}).catch(()=>m(!1))},S=(i,m)=>{m(!0),w(null,"teams_for_wc_memberships_refresh_member_roles").then(e=>{var t;if(e&&(e!=null&&e.success)&&((t=e==null?void 0:e.data)!=null&&t.roles)){i(d=>h(d,n=>{n.allMemberRoles=e.data.roles})),m(!1),M.success(a("All member roles fetched successfully","bit-integrations"));return}m(!1),M.error(a("Member roles fetch failed. Please try again","bit-integrations"))}).catch(()=>m(!1))},I=i=>!(!(i!=null&&i.selectedTeam)||["add_member_to_team","invite_user_to_team","update_member_role"].includes(i==null?void 0:i.mainAction)&&!(i!=null&&i.selectedMemberRole)||(i!=null&&i.field_map?i.field_map.filter(e=>!e.formField||!e.teamsForWooCommerceMembershipsField||e.formField==="custom"&&!e.customValue):[]).length>0),G=i=>{const m=i.filter(e=>e.required===!0);return m.length>0?m.map(e=>({formField:"",teamsForWooCommerceMembershipsField:e.key})):[{formField:"",teamsForWooCommerceMembershipsField:""}]};function B({i,formFields:m,field:e,teamsForWcConf:t,setTeamsForWcConf:d}){var g,x,_;const n=k(T),{isPro:u}=n,b=((g=t==null?void 0:t.teamsForWooCommerceMembershipsFields)==null?void 0:g.filter(s=>s.required===!0))||[],j=((x=t==null?void 0:t.teamsForWooCommerceMembershipsFields)==null?void 0:x.filter(s=>s.required===!1))||[];return l.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:l.jsxs("div",{className:"pos-rel flx",children:[l.jsxs("div",{className:"flx integ-fld-wrp",children:[l.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:s=>R(s,i,t,d),children:[l.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),l.jsx("optgroup",{label:a("Form Fields","bit-integrations"),children:m==null?void 0:m.map(s=>l.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`))}),l.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),l.jsx("optgroup",{label:V(a("General Smart Codes %s","bit-integrations"),u?"":`(${a("Pro","bit-integrations")})`),children:u&&((_=P)==null?void 0:_.map(s=>l.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`)))})]}),e.formField==="custom"&&l.jsx(U,{onChange:s=>z(s,i,t,d),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:a("Custom Value","bit-integrations"),formFields:m}),l.jsxs("select",{className:"btcd-paper-inp",disabled:i<b.length,name:"teamsForWooCommerceMembershipsField",value:i<b?b[i].label||"":e.teamsForWooCommerceMembershipsField||"",onChange:s=>R(s,i,t,d),children:[l.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),i<b.length?l.jsx("option",{value:b[i].key,children:b[i].label},b[i].key):j.map(({key:s,label:o})=>l.jsx("option",{value:s,children:o},s))]})]}),i>=b.length&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>E(i,t,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),l.jsx("button",{onClick:()=>D(i,t,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:l.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}const N=[{name:"add_member_to_team",label:a("Add Member to Team","bit-integrations")},{name:"remove_member_from_team",label:a("Remove Member from Team","bit-integrations")},{name:"invite_user_to_team",label:a("Invite User to Team","bit-integrations")},{name:"update_member_role",label:a("Update Member Role","bit-integrations")}];function L({formID:i,formFields:m,teamsForWcConf:e,setTeamsForWcConf:t,isLoading:d,setIsLoading:n,setSnackbar:u}){var x,_,s,o;const b=k(T),{isPro:j}=b,g=r=>{t(p=>h(p,c=>{c.mainAction=r,c.teamsForWooCommerceMembershipsFields=[{key:"user_email",label:a("User Email","bit-integrations"),required:!0}],c.field_map=G(c.teamsForWooCommerceMembershipsFields)})),A(t,n),["add_member_to_team","invite_user_to_team","update_member_role"].includes(r)||S(t,n)};return l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:a("Action:","bit-integrations")}),l.jsx(v,{title:"mainAction",defaultValue:(x=e==null?void 0:e.mainAction)!=null?x:null,className:"mt-2 w-5",onChange:r=>g(r),options:N==null?void 0:N.map(r=>({label:y(j,r.is_pro)?r.label:q(r.label),value:r.name,disabled:!y(j,r.is_pro)})),singleSelect:!0,closeOnSelect:!0})]}),(e==null?void 0:e.mainAction)&&l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Team:","bit-integrations")}),l.jsx(v,{title:"selectedTeam",defaultValue:(_=e==null?void 0:e.selectedTeam)!=null?_:null,className:"btcd-paper-drpdwn w-5",options:(e==null?void 0:e.allTeams)&&Array.isArray(e.allTeams)&&e.allTeams.map(r=>({label:r.team_name,value:r.team_id.toString()})),onChange:r=>t(p=>h(p,c=>{c.selectedTeam=r})),singleSelect:!0,closeOnSelect:!0}),l.jsx("button",{onClick:()=>A(t,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Teams","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]})]}),["add_member_to_team","invite_user_to_team","update_member_role"].includes(e==null?void 0:e.mainAction)&&l.jsxs(l.Fragment,{children:[l.jsx("br",{}),l.jsxs("div",{className:"flx",children:[l.jsx("b",{className:"wdt-200 d-in-b",children:a("Member Role:","bit-integrations")}),l.jsx(v,{title:"selectedMemberRole",defaultValue:(s=e==null?void 0:e.selectedMemberRole)!=null?s:null,className:"btcd-paper-drpdwn w-5",options:(e==null?void 0:e.allMemberRoles)&&Array.isArray(e.allMemberRoles)&&e.allMemberRoles.map(r=>({label:r.label,value:r.value})),onChange:r=>t(p=>h(p,c=>{c.selectedMemberRole=r})),singleSelect:!0,closeOnSelect:!0}),l.jsx("button",{onClick:()=>S(t,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Member Roles","bit-integrations")}'`},type:"button",disabled:d,children:"↻"})]})]}),d&&l.jsx($,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(e==null?void 0:e.mainAction)&&e.teamsForWooCommerceMembershipsFields&&l.jsxs("div",{className:"mt-4",children:[l.jsx("b",{className:"wdt-100",children:a("Map Fields","bit-integrations")}),l.jsx("div",{className:"btcd-hr mt-1"}),l.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[l.jsx("div",{className:"txt-dp",children:l.jsx("b",{children:a("Form Fields","bit-integrations")})}),l.jsx("div",{className:"txt-dp",children:l.jsx("b",{children:a("Teams for WooCommerce Memberships Fields","bit-integrations")})})]}),(o=e==null?void 0:e.field_map)==null?void 0:o.map((r,p)=>l.jsx(B,{i:p,field:r,teamsForWcConf:e,formFields:m,setTeamsForWcConf:t},`teams-wc-m-${p+9}`)),l.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:l.jsx("button",{onClick:()=>O(e.field_map.length,e,t),className:"icn-btn sh-sm",type:"button",children:"+"})}),l.jsx("br",{})]})]})}export{L as T,I as c,Z as h};
