var J=Object.defineProperty;var C=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var w=(l,o,d)=>o in l?J(l,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[o]=d,u=(l,o)=>{for(var d in o||(o={}))K.call(o,d)&&w(l,d,o[d]);if(C)for(var d of C(o))Q.call(o,d)&&w(l,d,o[d]);return l};import{d as L,j as t,_ as s}from"./main.2.7.8.js";import{d as m,u as V}from"./react-router-dom.BLIKw1eE.js";import{C as W,g as X}from"./Integrations.DsKoVZo5.js";import{P as j,a as f,c as Y,b as Z}from"./FieldMap.BRAgR9Ck.js";import{S as tt}from"./SnackMsg.DGLO5_fd.js";import{p as et}from"./postField.C4qL0e-C.js";import{z as it}from"./Note.CbpnsFnB.js";import{b as st}from"./Table.PPpIxK2a.js";import{t as at}from"./tutorialLinks.C1WWujPT.js";import{T}from"./TutorialLink.CvfNjaff.js";import"./index.rAvPDjud.js";import"./TagifyInput.AWOXl6wg.js";import"./tagify.YxUZd8Ix.js";import"./CopyIcn.CrDMgwxJ.js";function vt({formFields:l,setFlow:o,flow:d,allIntegURL:I}){var _,N,y;const[M,D]=m.useState([]),[O,$]=m.useState([]),[E,q]=m.useState([]),[g,A]=m.useState([]),U=V(),[z,v]=m.useState(!1),{podLinks:p}=at,[i,r]=m.useState({name:"Pods",type:"Pods",post_map:[{post_author:"logged_in_user"}],pod_field_map:[{}],pod_file_map:[{}],condition:{action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}}),[B,b]=m.useState({show:!1}),h=(e,a,c)=>{const n=u({},i);n[e]=a,r(n)},G=(e,a)=>{const c=u({},i);c[e]=a,L({post_type:a},"pods/fields").then(n=>{var F,P,S,k;n!=null&&n.success&&n!==void 0&&(D(Object.values((F=n==null?void 0:n.data)==null?void 0:F.podFields)),$(Object.values((P=n==null?void 0:n.data)==null?void 0:P.podFiles)),n!=null&&n.data&&(c.pod_field_map=Object.values((S=n==null?void 0:n.data)==null?void 0:S.podFields).filter(x=>x.required).map(x=>({formField:"",podFormField:x.key,required:x.required})),((k=c==null?void 0:c.pod_field_map)==null?void 0:k.length)<1&&(c.pod_field_map=[{}])),r(c))})};m.useEffect(()=>{L({},"pods/list","","GET").then(e=>{const{data:a}=e;A(a==null?void 0:a.post_types),q(a.users)})},[]);const R=(e,a)=>{const c=u({},i);a?c.condition.action_behavior=e:c.condition.action_behavior="",r(c)},H=()=>{if(!i.post_type){b({show:!0,msg:s("Pod can't be empty","bit-integrations")});return}if(!i.post_status){b({show:!0,msg:s("Post Status can't be empty","bit-integrations")});return}if(!Y(i)){b({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!Z(i)){b({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}v(!0),X(d,o,I,i,U,"","",v)};return t.jsxs("div",{style:{width:900},children:[t.jsx(tt,{snack:B,setSnackbar:b}),t.jsx(T,{title:"PODS",youTubeLink:p==null?void 0:p.youTubeLink}),t.jsx(T,{title:"PODS",docLink:p==null?void 0:p.docLink}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:s("Integration Name","bit-integrations")})}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:e=>h(e.target.name,e.target.value),name:"name",value:i.name,type:"text",placeholder:s("Integration Name...","bit-integrations")}),t.jsxs("div",{className:"mt-3",children:[t.jsx("b",{children:s("Pod","bit-integrations")})," ",t.jsx("span",{style:{color:"red"},children:"*"})]}),t.jsxs("select",{name:"post_type",onChange:e=>G(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-1",children:[t.jsx("option",{disabled:!0,selected:!0,children:"Select type"}),g==null?void 0:g.map((e,a)=>t.jsx("option",{value:e.name,children:e.label},`pod-${a*2}`))]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("b",{children:s("Post Status","bit-integrations")})," ",t.jsx("span",{style:{color:"red"},children:"*"})]}),t.jsxs("select",{name:"post_status",onChange:e=>h(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-1",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Status","bit-integrations")}),t.jsx("option",{value:"publish",children:s("Publish","bit-integrations")}),t.jsx("option",{value:"draft",children:s("Draft","bit-integrations")}),t.jsx("option",{value:"inherit",children:s("Inherit","bit-integrations")}),t.jsx("option",{value:"auto-draft",children:s("Auto-Draft","bit-integrations")}),t.jsx("option",{value:"private ",children:s("Private","bit-integrations")}),t.jsx("option",{value:"pending",children:s("Pending","bit-integrations")})]}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:s("Comment Status","bit-integrations")})}),t.jsxs("select",{name:"comment_status",onChange:e=>h(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-1",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Status","bit-integrations")}),t.jsx("option",{value:"open",children:s("Open","bit-integrations")}),t.jsx("option",{value:"closed",children:s("Closed","bit-integrations")})]}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:s("Author","bit-integrations")})}),t.jsxs("select",{name:"post_author",onChange:e=>h(e.target.name,e.target.value),className:"btcd-paper-inp w-5 mt-1",children:[t.jsx("option",{disabled:!0,selected:!0,children:s("Select Author","bit-integrations")}),t.jsx("option",{value:"logged_in_user",children:s("Logged In User","bit-integrations")}),E.map((e,a)=>t.jsx("option",{value:e.ID,children:e.display_name},`pod-${a*2}`))]}),t.jsxs("div",{children:[t.jsxs("div",{children:[t.jsx("div",{className:"mt-3 mb-1",children:t.jsx("b",{children:s("Post Fields Mapping","bit-integrations")})}),t.jsx("div",{className:"btcd-hr"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Post Fields","bit-integrations")})})]})]}),(_=i==null?void 0:i.post_map)==null?void 0:_.map((e,a)=>t.jsx(j,{i:a,type:"post",field:e,formFields:l,podsConf:i,setPodsConf:r,podFields:et,fieldType:"fields"},`analytics-m-${a+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>f("post_map",i.post_map.length,i,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsxs("div",{children:[t.jsx("div",{className:"mt-3 mb-1",children:t.jsx("b",{children:s("Pod Fields Mapping","bit-integrations")})}),t.jsx("div",{className:"btcd-hr"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Pod Fields","bit-integrations")})})]})]}),i.pod_field_map.map((e,a)=>t.jsx(j,{i:a,type:"pod",field:e,formFields:l,podsConf:i,setPodsConf:r,podFields:M,fieldType:"fields"},`analytics-m-${a+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>f("pod_field_map",i.pod_field_map.length,i,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsxs("div",{children:[t.jsx("div",{className:"mt-3 mb-1",children:t.jsx("b",{children:s("Pod File Upload Mapping","bit-integrations")})}),t.jsx("div",{className:"btcd-hr"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:s("Pod Fields","bit-integrations")})})]})]}),i.pod_file_map.map((e,a)=>t.jsx(j,{i:a,type:"podFile",field:e,formFields:l,podsConf:i,setPodsConf:r,podFields:O,fieldType:"file"},`analytics-m-${a+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>f("pod_file_map",i.pod_file_map.length,i,r),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),(i==null?void 0:i.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(st,{onChange:e=>R(e.target.value,e.target.checked),checked:((N=i==null?void 0:i.condition)==null?void 0:N.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:s("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((y=i==null?void 0:i.condition)==null?void 0:y.action_behavior)==="cond"&&t.jsx(W,{formFields:l,dataConf:i,setDataConf:r})]}),t.jsxs("button",{className:"btn f-left btcd-btn-lg purple sh-sm flx",type:"button",onClick:()=>H(),children:[s("Save","bit-integrations")," ",z&&t.jsx(it,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{vt as default};
